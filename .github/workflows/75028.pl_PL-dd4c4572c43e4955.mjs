(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[75028],{16243:e=>{if(!t)var t={map:function(e,t){var i={};return t?e.map(function(e,r){return i.index=r,t.call(i,e)}):e.slice()},naturalOrder:function(e,t){return e<t?-1:e>t?1:0},sum:function(e,t){var i={};return e.reduce(t?function(e,r,a){return i.index=a,e+t.call(i,r)}:function(e,t){return e+t},0)},max:function(e,i){return Math.max.apply(null,i?t.map(e,i):e)}};var i=function(){function e(e,t,i){return(e<<10)+(t<<5)+i}function i(e){var t=[],i=!1;function r(){t.sort(e),i=!0}return{push:function(e){t.push(e),i=!1},peek:function(e){return i||r(),void 0===e&&(e=t.length-1),t[e]},pop:function(){return i||r(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return i||r(),t}}}function r(e,t,i,r,a,s,o){this.r1=e,this.r2=t,this.g1=i,this.g2=r,this.b1=a,this.b2=s,this.histo=o}function a(){this.vboxes=new i(function(e,i){return t.naturalOrder(e.vbox.count()*e.vbox.volume(),i.vbox.count()*i.vbox.volume())})}return r.prototype={volume:function(e){return(!this._volume||e)&&(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var i=this.histo;if(!this._count_set||t){var r,a,s,o=0;for(r=this.r1;r<=this.r2;r++)for(a=this.g1;a<=this.g2;a++)for(s=this.b1;s<=this.b2;s++)o+=i[e(r,a,s)]||0;this._count=o,this._count_set=!0}return this._count},copy:function(){return new r(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(t){var i=this.histo;if(!this._avg||t){var r,a,s,o,n=0,l=0,_=0,d=0;for(a=this.r1;a<=this.r2;a++)for(s=this.g1;s<=this.g2;s++)for(o=this.b1;o<=this.b2;o++)n+=r=i[e(a,s,o)]||0,l+=r*(a+.5)*8,_+=r*(s+.5)*8,d+=r*(o+.5)*8;n?this._avg=[~~(l/n),~~(_/n),~~(d/n)]:this._avg=[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(e){var t=e[0]>>3;return gval=e[1]>>3,bval=e[2]>>3,t>=this.r1&&t<=this.r2&&gval>=this.g1&&gval<=this.g2&&bval>=this.b1&&bval<=this.b2}},a.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map(function(e){return e.color})},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,i=0;i<t.size();i++)if(t.peek(i).vbox.contains(e))return t.peek(i).color;return this.nearest(e)},nearest:function(e){for(var t,i,r,a=this.vboxes,s=0;s<a.size();s++)((i=Math.sqrt(Math.pow(e[0]-a.peek(s).color[0],2)+Math.pow(e[1]-a.peek(s).color[1],2)+Math.pow(e[2]-a.peek(s).color[2],2)))<t||void 0===t)&&(t=i,r=a.peek(s).color);return r},forcebw:function(){var e=this.vboxes;e.sort(function(e,i){return t.naturalOrder(t.sum(e.color),t.sum(i.color))});var i=e[0].color;i[0]<5&&i[1]<5&&i[2]<5&&(e[0].color=[0,0,0]);var r=e.length-1,a=e[r].color;a[0]>251&&a[1]>251&&a[2]>251&&(e[r].color=[255,255,255])}},{quantize:function(s,o){if(!s.length||o<2||o>256)return!1;var n,l,_,d,u,c,p,h,g,m,I,E=(l=Array(32768),s.forEach(function(t){l[n=e(t[0]>>3,t[1]>>3,t[2]>>3)]=(l[n]||0)+1}),l),P=0;E.forEach(function(){P++});var f=(c=1e6,p=0,h=1e6,g=0,m=1e6,I=0,s.forEach(function(e){_=e[0]>>3,d=e[1]>>3,u=e[2]>>3,_<c?c=_:_>p&&(p=_),d<h?h=d:d>g&&(g=d),u<m?m=u:u>I&&(I=u)}),new r(c,p,h,g,m,I,E)),y=new i(function(e,i){return t.naturalOrder(e.count(),i.count())});function T(i,r){for(var a,s=1,o=0;o<1e3;){if(!(a=i.pop()).count()){i.push(a),o++;continue}var n=function(i,r){if(r.count()){var a=r.r2-r.r1+1,s=r.g2-r.g1+1,o=r.b2-r.b1+1,n=t.max([a,s,o]);if(1==r.count())return[r.copy()];var l,_,d,u,c=0,p=[],h=[];if(n==a)for(l=r.r1;l<=r.r2;l++){for(u=0,_=r.g1;_<=r.g2;_++)for(d=r.b1;d<=r.b2;d++)u+=i[e(l,_,d)]||0;c+=u,p[l]=c}else if(n==s)for(l=r.g1;l<=r.g2;l++){for(u=0,_=r.r1;_<=r.r2;_++)for(d=r.b1;d<=r.b2;d++)u+=i[e(_,l,d)]||0;c+=u,p[l]=c}else for(l=r.b1;l<=r.b2;l++){for(u=0,_=r.r1;_<=r.r2;_++)for(d=r.g1;d<=r.g2;d++)u+=i[e(_,d,l)]||0;c+=u,p[l]=c}return p.forEach(function(e,t){h[t]=c-e}),function(e){var t,i,a,s,o,n=e+"1",_=e+"2",d=0;for(l=r[n];l<=r[_];l++)if(p[l]>c/2){for(a=r.copy(),s=r.copy(),o=(t=l-r[n])<=(i=r[_]-l)?Math.min(r[_]-1,~~(l+i/2)):Math.max(r[n],~~(l-1-t/2));!p[o];)o++;for(d=h[o];!d&&p[o-1];)d=h[--o];return a[_]=o,s[n]=a[_]+1,[a,s]}}(n==a?"r":n==s?"g":"b")}}(E,a),l=n[0],_=n[1];if(!l||(i.push(l),_&&(i.push(_),s++),s>=r||o++>1e3))return}}y.push(f),T(y,.75*o);for(var A=new i(function(e,i){return t.naturalOrder(e.count()*e.volume(),i.count()*i.volume())});y.size();)A.push(y.pop());T(A,o-A.size());for(var b=new a;A.size();)b.push(A.pop());return b}}}();e.exports=i.quantize},509550:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});let r=(e,t)=>{let i=new Date(e);return i.setDate(e.getDate()+t),i}},984234:(e,t,i)=>{"use strict";i.d(t,{Z:()=>o});var r=i(624797);function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let s={carousel:{authOnly:!0,partnerOnly:!0,orbacExperiment:"web_m10n_business_access_orbac_www"},disabledIdeaPinCreation:{experiment:"disable_pin_creation",groups:/(disable_all|disable_idea_pins|disable_video)/,authOnly:!0,partnerOnly:!1},disabledPinCreation:{experiment:"disable_pin_creation",groups:/(disable_all|disable_web_pins)/,authOnly:!0,partnerOnly:!1},disabledVideoPinCreation:{experiment:"disable_pin_creation",groups:/(disable_all|disable_video)/,authOnly:!0,partnerOnly:!1},editing:{authOnly:!0,partnerOnly:!0},education:{authOnly:!0,partnerOnly:!0},offsitePinCreation:{scenarios:["offsite_pin_creation"]},layouts:{authOnly:!0,partnerOnly:!0,scenarios:["default","ad_creation","story_pin"]},linkStatusValidation:{authOnly:!0,partnerOnly:!0},requireLink:{scenarios:["ad_creation"]},multi_pin:{authOnly:!0,partnerOnly:!0,scenarios:["default","ad_creation"]},multi_pin_pinner:{authOnly:!0,partnerOnly:!1,scenarios:["default"]},offsite_pin_creation_multi_select:{authOnly:!0,partnerOnly:!1,experiment:"web_offsite_pin_creation_multi_select",groups:/^(enabled|employees|enabled_redirect_to_hf)/,scenarios:["offsite_pin_creation"]},imageSignals:{authOnly:!0,partnerOnly:!0,experiment:"pin_quality_signal_image",groups:/^(employees|enabled)/},scheduling:{authOnly:!0,partnerOnly:!0,scenarios:["default"],orbacExperiment:"web_m10n_business_access_orbac_www"},shop_the_pin:{authOnly:!0,partnerOnly:!0,orbacExperiment:"web_m10n_business_access_orbac_www"},storyPinCommentsPermissions:{authOnly:!0,partnerOnly:!1,groups:/^(employees|enabled)/,scenarios:["story_pin_v2"],orbacExperiment:"web_m10n_business_access_orbac_www"},systemFonts:{authOnly:!0,partnerOnly:!0},tagging:{authOnly:!0,partnerOnly:!0,experiment:"web_pin_builder_tagging",groups:/^(employees|enabled|rollout)/,orbacExperiment:"web_m10n_business_access_orbac_www"},suppressSuccessModal:{scenarios:["ad_creation","business_nux"]},video:{customEnabledCheck:({user:e})=>!!e?.video_upload_allowed,authOnly:!0,hasCustomEnabledCheck:()=>!0,orbacExperiment:"web_m10n_business_access_orbac_www"},videoEditing:{authOnly:!0,partnerOnly:!0,experiment:"video_edit",groups:/^(employees|enabled)/,orbacDisabled:!0},videoTagging:{authOnly:!0,partnerOnly:!0,languages:["en"],orbacExperiment:"web_m10n_business_access_orbac_www"},pinQuality:{partnerOnly:!0},ideaPinCreationWithoutThinking:{authOnly:!0,experiment:"web_snc_pin_creation_without_thinking",groups:/^(employees|enabled)/,partnerOnly:!1,scenarios:["story_pin_v2"]}},o=new class{constructor(){a(this,"_experiments",null),a(this,"_viewer",null),a(this,"_advertiser",null),a(this,"_scenario",null),a(this,"_language",null),a(this,"_context",null),a(this,"_orbacActingAs",null)}initialize(e){let{requestContext:t,viewer:i,location:a,advertiser:s,scenario:o,orbacActingAs:n}=e;this._context=e,this._experiments=t.experimentsClient,this._language=t.language,this._viewer=i,this._advertiser=s,this._orbacActingAs=n;let{adCreate:l}=(0,r.mB)(a.search);o?this._scenario=o:l?this._scenario="ad_creation":this._scenario="default"}scenario(){return this._scenario}enabled(e){if(!this._viewer||!this._experiments)return!1;let{advertisers:t,authOnly:i,customEnabledCheck:r,experiment:a,groups:o=/.*/,hasCustomEnabledCheck:n,languages:l,orbacDisabled:_,orbacExperiment:d,partnerOnly:u,scenarios:c,skipActivation:p}=s[e];return(!this._orbacActingAs?.id||this._orbacActingAs.id===this._viewer.id||!_&&(!d||"enabled"===this.getORBACExperimentGroup(e)))&&(n&&r&&this._context&&n(this._context)?!!this._context&&r(this._context):p&&this._experiments?!!a&&this.checkExperimentWithSkipActivation(e):!!t&&!!this._advertiser&&null!==this._advertiser.billing_type||(!this._viewer||!i||!!this._viewer.isAuth)&&(!this._viewer||!u||!!this._viewer.isPartner)&&(!c||!!c.includes(this._scenario))&&(!l||!!l.includes(this._language))&&(!a||o.test(this.getExperimentGroup(e)||"")))}getExperimentGroup(e){if(!this._viewer||!this._experiments)return null;let{checkExperiment:t}=this._experiments;switch(e){case"disabledIdeaPinCreation":case"disabledPinCreation":case"disabledVideoPinCreation":return t("disable_pin_creation").group??null;case"offsite_pin_creation_multi_select":return t("web_offsite_pin_creation_multi_select").group??null;case"imageSignals":return t("pin_quality_signal_image").group??null;case"tagging":return t("web_pin_builder_tagging").group??null;case"videoEditing":return t("video_edit").group??null;case"ideaPinCreationWithoutThinking":return t("web_snc_pin_creation_without_thinking").group??null;default:return null}}checkExperimentWithSkipActivation(e){if(!this._viewer||!this._experiments)return!1;let{checkExperiment:t}=this._experiments;switch(e){case"disabledIdeaPinCreation":case"disabledPinCreation":case"disabledVideoPinCreation":return t("disable_pin_creation",{dangerouslySkipActivation:!0}).anyEnabled??!1;case"offsite_pin_creation_multi_select":return t("web_offsite_pin_creation_multi_select",{dangerouslySkipActivation:!0}).anyEnabled??!1;case"imageSignals":return t("pin_quality_signal_image",{dangerouslySkipActivation:!0}).anyEnabled??!1;case"tagging":return t("web_pin_builder_tagging",{dangerouslySkipActivation:!0}).anyEnabled??!1;case"videoEditing":return t("video_edit",{dangerouslySkipActivation:!0}).anyEnabled??!1;case"ideaPinCreationWithoutThinking":return t("web_snc_pin_creation_without_thinking",{dangerouslySkipActivation:!0}).anyEnabled??!1;default:return!1}}getORBACExperimentGroup(e){if(!this._viewer||!this._experiments)return null;let{checkExperiment:t}=this._experiments;return["carousel","scheduling","shop_the_pin","storyPinCommentsPermissions","tagging","video","videoTagging"].includes(e)?t("web_m10n_business_access_orbac_www").group??null:null}}},625303:(e,t,i)=>{"use strict";i.d(t,{SD:()=>s,TA:()=>a,to:()=>r});let r=e=>{let t=Math.floor(100*e||0),i=Math.floor(t/6e3),r=Math.floor((t-6e3*i)/100),a=t-6e3*i-100*r,s=i<10?`0${i}`:i,o=r<10?`0${r}`:r,n=a<10?`0${a}`:a;return`${s}:${o}:${n}`},a=e=>{let t=r(e);return`00:${t.substring(0,5)}:00`},s=e=>{let t=e.split(":"),i=0;return 3===t.length&&(i+=(isNaN(t[0])?0:60*+t[0])+(isNaN(t[1])?0:+t[1])+(isNaN(t[2])?0:+t[2]/100)),i}},749886:(e,t,i)=>{"use strict";i.d(t,{Cc:()=>p,DL:()=>_,Gf:()=>m,LX:()=>a,Lc:()=>I,Ls:()=>h,Rf:()=>l,YL:()=>n,ap:()=>s,h8:()=>u,pE:()=>d,s5:()=>g,tQ:()=>c,yR:()=>o});var r=i(883119);let a={w:9,h:16},s=a.w/a.h,o=8,n=10,l=5e3,_=2e3;function d(e,t=1){return{x:(e??24)/5,y:(e??24)*(t-1)}}let u={COMMENT_REPLY_STICKER:"story_pin_comment_reply_block",GENERIC_STICKER:"story_pin_generic_interactive_sticker_block",HEADING:"story_pin_heading_block",IMAGE:"story_pin_image_block",INGREDIENT:"story_pin_ingredient_block",LINK:"story_pin_link_block",MENTION_STICKER:"story_pin_mention_sticker_block",MUSIC:"story_pin_music_block",PARAGRAPH:"story_pin_paragraph_block",PRODUCT_STICKER:"story_pin_product_sticker_block",SUPPLY:"story_pin_supply_block",VIDEO:"story_pin_video_block",VTO_MAKEUP_STICKER:"story_pin_virtual_try_on_makeup_sticker_block"},c=[u.IMAGE,u.VIDEO],p={alignment:1,hex_color:"#111111",highlight_color:"#FFFFFF",vertical_alignment:1,font:{default_size:28,id:"1",key:"Graphik-Regular.otf",letter_spacing:-.4,line_height:1.25,name:"Teaspoon",url:"https://s.pinimg.com/story_pins/fonts/Graphik-Regular.otf"},font_size:28},h=new r.Ry(1),g=new r.H3([h]),m=new r.H3([g]),I=e=>{let t=Math.floor(e||0),i=Math.floor(t/60),r=t-60*i,a=i<10?`${i}`:i,s=r<10?`0${r}`:r;return`${a}:${s}`}},622270:(e,t,i)=>{"use strict";i.d(t,{Z:()=>n});var r=i(339001),a=i(203966),s=i(984234);let o=(e,t)=>t.nbt(["piks.", "piks.", "piks."], e, "pinBuilder.errorMessaging.pixel", true);function n(e,t,i,n){switch(e){case"FILE_UNRECOGNIZED_TYPE":return{dispatchId:i,id:"FILE_UNRECOGNIZED_TYPE",type:"error",message:t.bt("Przesyłanie nie powiodło się, ponieważ format pliku jest nieprawidłowy.", "Your upload failed because it's the wrong format.", "vip.errorMessaging.message", undefined, true),blocking:!0};case"IMAGE_OVER_MAX_DIMENSIONS":return{dispatchId:i,id:"IMAGE_OVER_MAX_DIMENSIONS",type:"error",message:t.bt("Ten obraz jest zbyt duży, dlatego nie można go przesłać. Spróbuj przesłać mniejszy obraz.", "This image is too large and can't be uploaded. Please try a smaller image size.", "vip.errorMessaging.message", undefined, true),blocking:!0};case"IMAGE_UNDER_MIN_DIMENSIONS":let[l,_]=s.Z.enabled("pinQuality")||n?.isStoryPin?[300,200]:[100,100];return{dispatchId:i,id:"IMAGE_UNDER_MIN_DIMENSIONS",type:"error",message:(0,r.nk)(t.bt("Hmm... ten obraz jest za mały. Upewnij się, że obrazy mają rozmiar co najmniej {{ minWidth }} x {{ minHeight }} {{ pixelString }}.", "Hmm...this image is too small. Make sure your images are at least {{ minWidth }} x {{ minHeight }} {{ pixelString }}.", "vip.errorMessaging.minImageMessage", undefined, true),{minHeight:l,minWidth:_,pixelString:o(_,t)}).join(""),blocking:!0};case"IMAGE_OVER_MAX_FILE_SIZE":return{dispatchId:i,id:"IMAGE_OVER_MAX_FILE_SIZE",type:"error",message:(0,r.nk)(t.nbt(["Ten obraz ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar obrazu to {{max_size_mb}} MB.", "Ten obraz ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar obrazu to {{max_size_mb}} MB.", "Ten obraz ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar obrazu to {{max_size_mb}} MB."], 20, "vip.errorMessaging.message", true),{max_size_mb:20}).join(""),blocking:!0};case"IMAGE_UNRECOGNIZED_TYPE":return{dispatchId:i,id:"IMAGE_UNRECOGNIZED_TYPE",type:"error",message:t.bt("Ten typ obrazu jest nieprawidłowy — upewnij się, że natywny format obrazu to .jpg lub .png", "This image type is invalid - please make sure the image is natively .jpg or .png", "vip.errorMessaging.message", undefined, true),blocking:!0};case"VIDEO_UNDER_MIN_DIMENSIONS":return{dispatchId:i,id:"VIDEO_UNDER_MIN_DIMENSIONS",type:"error",message:(0,r.nk)(t.nbt(["Ten film ma zbyt mały rozmiar obrazu, dlatego nie można go przesłać. Wysokość i szerokość obrazu filmu wyrażona w pikselach musi przekraczać {{min_size_video}}.", "Ten film ma zbyt mały rozmiar obrazu, dlatego nie można go przesłać. Wysokość i szerokość obrazu filmu wyrażona w pikselach musi przekraczać {{min_size_video}}.", "Ten film ma zbyt mały rozmiar obrazu, dlatego nie można go przesłać. Wysokość i szerokość obrazu filmu wyrażona w pikselach musi przekraczać {{min_size_video}}."], 100, "vip.errorMessaging.message", true),{min_size_video:100}).join(""),blocking:!0};case"VIDEO_BELOW_MIN_DURATION":let d=Math.floor(4);return{dispatchId:i,id:"VIDEO_BELOW_MIN_DURATION",type:"error",message:(0,r.nk)(t.nbt(["Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} sekunda.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} sekundy.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} sekund."], d, "vip.errorMessaging.message", true),{minVideoLengthSeconds:d}).join(""),blocking:!0};case"STORY_PIN_VIDEO_BELOW_MIN_DURATION":let u=a.W_;return{dispatchId:i,id:"STORY_PIN_VIDEO_BELOW_MIN_DURATION",type:"error",message:(0,r.nk)(t.nbt(["Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minStoryPinVideoLengthSeconds}} sekunda.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minStoryPinVideoLengthSeconds}} sekundy.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minStoryPinVideoLengthSeconds}} sekund."], u, "vip.errorMessaging.storyPinVideoBelowMin.message", true),{minStoryPinVideoLengthSeconds:u}).join(""),blocking:!0};case"VIDEO_COVER_INVALID_ASPECT_RATIO":return{dispatchId:i,id:"VIDEO_COVER_INVALID_ASPECT_RATIO",type:"error",message:t.bt("Obraz główny filmu musi mieć takie same wymiary jak film", "The video's cover image must be of the same dimensions as the video itself", "vip.errorMessaging.message", undefined, true),blocking:!0};case"VIDEO_GENERAL_UPLOAD_ERROR":return{dispatchId:i,id:"VIDEO_GENERAL_UPLOAD_ERROR",type:"error",message:t.bt("Przesyłanie nie powiodło się. Spróbuj ponownie.", "Hmm, your upload failed for some reason. Please try again.", "vip.errorMessaging.message", undefined, true),blocking:!0};case"VIDEO_OVER_MAX_DURATION":return{dispatchId:i,id:"VIDEO_OVER_MAX_DURATION",type:"error",message:(0,r.nk)(t.nbt(["Ten film jest zbyt długi i nie można go przesłać. Maksymalna długość filmu to {{max_video_length_minutes}} min.", "Ten film jest zbyt długi i nie można go przesłać. Maksymalna długość filmu to {{max_video_length_minutes}} min.", "Ten film jest zbyt długi i nie można go przesłać. Maksymalna długość filmu to {{max_video_length_minutes}} min."], 15, "vip.errorMessaging.message", true),{max_video_length_minutes:15}).join(""),blocking:!0};case"STORY_PIN_VIDEO_OVER_MAX_DURATION":return{dispatchId:i,id:"STORY_PIN_VIDEO_OVER_MAX_DURATION",type:"error",message:(0,r.nk)(t.bt("Ten film jest zbyt długi i nie można go przesłać. Maksymalna długość filmu to {{max_video_length_seconds}} s.", "This video is too long and can't be uploaded. Videos can't be longer than {{max_video_length_seconds}} seconds.", "vip.errorMessaging.message", undefined, true),{max_video_length_seconds:Math.floor(a.P9)}).join(""),blocking:!0};case"VIDEO_OVER_MAX_FILE_SIZE":return{dispatchId:i,id:"VIDEO_OVER_MAX_FILE_SIZE",type:"error",message:(0,r.nk)(t.nbt(["Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{max_video_size_gb}} GB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{max_video_size_gb}} GB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{max_video_size_gb}} GB."], 2, "vip.errorMessaging.message", true),{max_video_size_gb:2}).join(""),blocking:!0};case"STORY_PIN_VIDEO_OVER_MAX_FILE_SIZE":{let e=a.Lr/1024/1024;return{dispatchId:i,id:"STORY_PIN_VIDEO_OVER_MAX_FILE_SIZE",type:"error",message:(0,r.nk)(t.nbt(["Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB."], e, "vip.errorMessaging.message", true),{maxVideoFileSize:e}).join(""),blocking:!0}}case"VIDEO_UNRECOGNIZED_ENCODING":return{dispatchId:i,id:"VIDEO_UNRECOGNIZED_ENCODING",type:"error",message:t.bt("Ten film nie jest kodowany w formacie H.264", "This video isn't encoded in H.264", "vip.errorMessaging.message", undefined, true),blocking:!0};case"VIDEO_UNRECOGNIZED_ENCODING_IN_CHROME":return{dispatchId:i,id:"VIDEO_UNRECOGNIZED_ENCODING_IN_CHROME",type:"error",message:t.bt("Ten film nie jest kodowany w formacie H.264 ani H.265. Jeśli chcesz przesłać filmy ProRes, użyj przeglądarki Safari.", "This video isn't encoded in H.264 or H.265. Please use Safari if you want to upload ProRes videos.", "vip.errorMessaging.message.chrome", undefined, true),blocking:!0};case"VIDEO_UNRECOGNIZED_ENCODING_IN_FIREFOX":return{dispatchId:i,id:"VIDEO_UNRECOGNIZED_ENCODING_IN_FIREFOX",type:"error",message:t.bt("Ten film nie jest kodowany w formacie H.264. Jeśli chcesz przesłać filmy H.265 lub ProRes, użyj przeglądarki Safari.", "This video isn't encoded in H.264. Please use Safari if you want to upload H.265 or ProRes videos.", "vip.errorMessaging.message.firefox", undefined, true),blocking:!0};case"VIDEO_UNRECOGNIZED_ENCODING_IN_SAFARI":return{dispatchId:i,id:"VIDEO_UNRECOGNIZED_ENCODING_IN_SAFARI",type:"error",message:t.bt("Ten film nie jest kodowany w formacie H.264, H.265 ani ProRes.", "This video isn't encoded in H.264 or H.265 or ProRes.", "vip.errorMessaging.message.safari", undefined, true),blocking:!0};case"VIDEO_UNSUPPORTED_RATIO":return{dispatchId:i,id:"VIDEO_UNSUPPORTED_RATIO",type:"error",message:t.bt("Ten film jest zbyt wysoki lub zbyt wąski, dlatego nie można go przesłać. Współczynnik proporcji filmów powinien mieścić się w przedziale od 1:2 do 1,91:1.", "This video is too tall or narrow and can't be uploaded. Videos need to be between 1:2 and 1.91:1 aspect ratio.", "vip.errorMessaging.message", undefined, true),blocking:!0};default:return{dispatchId:i,id:"GENERAL_ERROR",type:"error",message:t.bt("Coś poszło nie tak. Spróbuj ponownie.", "Hmm, something went wrong. Please try again.", "vip.errorMessaging.message", undefined, true),blocking:!0}}}},622350:(e,t,i)=>{"use strict";i.d(t,{GB:()=>h,ZP:()=>p,q0:()=>c});var r=i(883119),a=i(339001),s=i(203966),o=i(427514),n=i(702497),l=i(843964),_=i(622270),d=i(961936),u=i(785893);let c=e=>e.bt("Nieprawidłowy adres URL.", "Not a valid URL.", "storyPinBuilder.errorMessaging.message", undefined, true);function p({dispatchId:e,errorId:t,i18n:i,ideaPinRenamingEnabled:l,options:p}){let h=(0,_.Z)(t,i,e,p);if("GENERAL_ERROR"!==h.id)return h;switch(t){case"DESCRIPTION_OVER_MAX_CHARACTER_LIMIT":return{dispatchId:e,id:"DESCRIPTION_OVER_MAX_CHARACTER_LIMIT",type:"error",message:i.bt("Ups! Ten opis może okazać się zbyt długi. Spróbuj go skrócić.", "Ooops! This description is getting long. Try trimming it down.", "storyPinBuilder.errorMessaging.message", undefined, true)};case"DESCRIPTION_OVER_MAX_USER_MENTION_LIMIT":return{dispatchId:e,id:"DESCRIPTION_OVER_MAX_USER_MENTION_LIMIT",type:"error",message:i.bt("Ups! Oznaczono zbyt wielu użytkowników. Ogranicz ich liczbę do 5.", "Ooops! Too many user mentions. Try keeping it to 5 max.", "pinBuilder.errorMessaging.descriptionMentionLimit", undefined, true)};case"TITLE_OVER_MAX_CHARACTER_LIMIT":return{dispatchId:e,id:"TITLE_OVER_MAX_CHARACTER_LIMIT",type:"error",message:i.bt("Ups! Ten tytuł może okazać się zbyt długi. Spróbuj go skrócić.", "Ooops! This title is getting long. Try trimming it down.", "storyPinBuilder.errorMessaging.message", undefined, true)};case"IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO":return{dispatchId:e,id:"IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO",type:"error",message:i.bt("Ten obraz nie ma zalecanego współczynnika proporcji.", "This image does not have the recommended aspect ratio.", "storyPinBuilder.errorMessaging.message", undefined, true)};case"TAG_SAME_PRODUCT_LINK":return{dispatchId:e,id:"TAG_SAME_PRODUCT_LINK",type:"error",message:i.bt("Nie możesz dodać tagu z tej samej strony dwukrotnie.", "You can't tag from the same page twice.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"TAG_OVER_MAX_PRODUCTS_LIMIT":return{dispatchId:e,id:"TAG_OVER_MAX_PRODUCTS_LIMIT",type:"error",message:i.bt("Limit produktów przypadający na jeden tag został osiągnięty.", "You've reached the maximum number of products for a tag.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"BOARD_MISSING":return{dispatchId:e,id:"BOARD_MISSING",type:"error",message:i.bt("Do utworzenia Pina wymagana jest tablica.", "A board is required to create a Pin.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"DATE_IN_PAST":return{dispatchId:e,id:"DATE_IN_PAST",type:"error",message:i.bt("Do zaplanowania publikacji Pina wymagana jest przyszła data.", "A future date is required to schedule a Pin.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"DATE_TOO_FAR_IN_FUTURE":return{dispatchId:e,id:"DATE_TOO_FAR_IN_FUTURE",type:"error",message:i.bt("Upewnij się, że publikacja Pina jest zaplanowana z wyprzedzeniem do 30 dni.", "Make sure you schedule a Pin less than 30 days in the future.", "storyPinBuilder.errorMessaging.30DayMessage", undefined, true),blocking:!0};case"DATE_MISSING":return{dispatchId:e,id:"DATE_MISSING",type:"error",message:i.bt("Do zaplanowania publikacji Pina wymagana jest data.", "A date is required to schedule a Pin.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"DESCRIPTION_INVALID":return{dispatchId:e,id:"DESCRIPTION_INVALID",type:"error",message:i.bt("Nieprawidłowy opis.", "The description is invalid.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"MEDIA_MISSING":return{dispatchId:e,id:"MEDIA_MISSING",type:"error",message:i.bt("Do utworzenia Pina wymagany jest obraz.", "An image is required to create a Pin.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"SHOWCASE_UNSUPPORTED_FORMAT":return{dispatchId:e,id:"SHOWCASE_UNSUPPORTED_FORMAT",type:"error",message:i.bt("Obecnie reklamy z prezentacją nie obsługują filmów. Aby kontynuować, prześlij obraz.", "Showcase ads don’t currently support video. To continue, please upload an image.", "showcasePinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"TAG_INVALID":return{dispatchId:e,id:"TAG_INVALID",type:"error",message:i.bt("Możesz dodawać tagi tylko do obrazów z przekierowaniem do Twojej potwierdzonej witryny.", "You can only tag images linking to your claimed website.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"TAG_EMPTY":return{dispatchId:e,id:"TAG_EMPTY",type:"error",message:i.bt("Aby kontynuować, musisz oznaczyć tagiem co najmniej jednego polecanego Pina.", "You must tag at least one feature Pin to continue.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"TIME_MISSING":return{dispatchId:e,id:"TIME_MISSING",type:"error",message:i.bt("Do zaplanowania publikacji Pina wymagana jest godzina.", "A time is required to schedule a Pin.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"TITLE_INVALID":return{dispatchId:e,id:"TITLE_INVALID",type:"error",message:i.bt("Nieprawidłowy tytuł.", "The title is invalid.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"URL_INVALID":return{dispatchId:e,id:"URL_INVALID",type:"error",message:c(i),blocking:!0};case"URL_MISSING":return{dispatchId:e,id:"URL_MISSING",type:"error",message:i.bt("Wymagany jest adres URL.", "URL is required.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"URL_CONTAINS_PORN_DOMAIN":return{dispatchId:e,id:"URL_CONTAINS_PORN_DOMAIN",type:"error",message:(0,a.nk)(i.bt("Pewne rodzaje nagości są na Pintereście dopuszczalne, a inne nie. Upewnij się, że rozumiesz treść dokumentu {{ policy_link }}", "Some nudity is okay for Pinterest, some isn't. Make sure you understand {{ policy_link }}", "storyPinBuilder.errorMessaging.message", undefined, true),{policy_link:(0,u.jsx)(r.rU,{display:"inlineBlock",href:n.MsG,target:"blank",underline:"hover",children:(0,u.jsx)(r.xv,{color:"error",inline:!0,size:"100",weight:"bold",children:i.bt("naszych zasad.", "our policies", "Link to policy page", undefined, true)})},0)}),blocking:!0};case"URL_IS_TOO_LONG":return{dispatchId:e,id:"URL_IS_TOO_LONG",type:"error",message:(0,o.Z)(i.bt("Skróć link do maksymalnie {{ maxLength }} znaków.", "Please shorten the link to {{ maxLength }} characters or fewer.", "pinbuilder.urlIsTooLong.errorMessage", undefined, true),{maxLength:s.cH}),blocking:!0};case"URL_IS_BLOCKED":return{dispatchId:e,id:"URL_IS_BLOCKED",type:"error",message:i.bt("Link został zablokowany, ponieważ istnieje podejrzenie, że nie jest zgodny z naszymi zasadami dotyczącymi treści.", "This link is blocked because it may not meet our content policies.", "pinbuilder.blockedUrl.errorMessage", undefined, true),blocking:!0};case"CAROUSEL_DIFFERENT_RATIOS":return{dispatchId:e,id:"CAROUSEL_DIFFERENT_RATIOS",type:"error",message:i.bt("Obrazy w Pinie karuzelowym muszą mieć taką samą wysokość i szerokość", "Carousel images must have the same height and width", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"CAROUSEL_INVALID_FORMAT":return{dispatchId:e,id:"CAROUSEL_INVALID_FORMAT",type:"error",message:i.bt("Piny karuzelowe mogą zawierać tylko obrazy", "Carousels can only contain images", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"URL_IS_REDIRECT":return{dispatchId:e,id:"URL_IS_REDIRECT",type:"error",message:i.bt("Adres URL przekierowuje dalej. Wpisz adres URL, który nie przekierowuje dalej.", "URL is a redirect. Please enter a URL without a redirect.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"URL_UNREACHABLE":return{dispatchId:e,id:"URL_UNREACHABLE",type:"error",message:i.bt("Adres URL jest nieosiągalny. Sprawdź, czy jest prawidłowy.", "URL is unreachable. Please check that it is correct.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_COVER_PAGE_INVALID_ASPECT_RATIO":return{dispatchId:e,id:"STORY_PIN_COVER_PAGE_INVALID_ASPECT_RATIO",type:"error",message:i.bt("Zmień proporcje obrazu na stronie okładki na 9:16", "Edit the image on the cover page to have a 9:16 ratio", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_COVER_PAGE_IMAGE_MISSING":return{dispatchId:e,id:"STORY_PIN_COVER_PAGE_IMAGE_MISSING",type:"error",message:l?i.bt("Dodaj obraz na stronę okładki Pina.", "Please provide an image for the cover page of your Pin", "storyPinBuilder.errorMessaging.storypinCoverPageImageMissing", undefined, true):i.bt("Dodaj obraz na stronę okładki Twojego Pina z pomysłem", "Please provide an image for the cover page of your Idea Pin", "storyPinBuilder.errorMessaging.message", undefined, true)};case"STORY_PIN_COVER_PAGE_SIGNATURE_MISSING":return{dispatchId:e,blocking:!0,id:"STORY_PIN_COVER_PAGE_SIGNATURE_MISSING",type:"error",message:l?i.bt("Nie można zapisać Pina bez podpisu na okładce", "Cannot save Pin without signature set on cover", "storyPinBuilder.errorMessaging.storyPinCoverPageSignatureMissing", undefined, true):i.bt("Nie można zapisać Pina z pomysłem bez podpisu na stronie okładki", "Cannot save Idea Pin without signature set on cover", "storyPinBuilder.errorMessaging.message", undefined, true)};case"STORY_PIN_COVER_PAGE_TITLE_MISSING":return{dispatchId:e,id:"STORY_PIN_COVER_PAGE_TITLE_MISSING",type:"error",message:l?i.bt("Nadaj tytuł Pinowi, zanim go opublikujesz.", "Give your Pin a title before you publish", "storyPinBuilder.errorMessaging.storyPinCoverPageTittleMissing", undefined, true):i.bt("Nadaj tytuł Pinowi z pomysłem, zanim go opublikujesz", "Give your Idea Pin a title before you publish", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_MEDIA_SIGNATURES_MISSING":return{dispatchId:e,blocking:!0,id:"STORY_PIN_MEDIA_SIGNATURES_MISSING",type:"error",message:l?i.bt("Nie można zapisać Pina bez podpisów we wszystkich blokach/elementach multimedialnych.", "Cannot save Pin without signatures set on all media blocks/items", "storyPinBuilder.errorMessaging.storyPinMediaSignatureMissing", undefined, true):i.bt("Nie można zapisać Pina z pomysłem bez podpisów we wszystkich blokach/elementach multimedialnych", "Cannot save Idea Pin without signatures set on all media blocks/items", "storyPinBuilder.errorMessaging.message", undefined, true)};case"STORY_PIN_NOT_ENOUGH_PAGES":return{dispatchId:e,id:"STORY_PIN_NOT_ENOUGH_PAGES",type:"error",message:l?i.bt("Utwórz co najmniej dwie strony, aby opublikować Pina.", "Create at least 2 pages to publish a Pin", "storyPinBuilder.errorMessaging.storyPinNotEnoughPages", undefined, true):i.bt("Utwórz co najmniej dwie strony, aby opublikować Pina z pomysłem", "Create at least 2 pages to publish an Idea Pin", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_TOO_MANY_DRAFTS":return{dispatchId:e,id:"STORY_PIN_TOO_MANY_DRAFTS",type:"error",message:(0,a.nk)(i.bt("Osiągnięto limit {{draftMaxCount}} wersji roboczych.", "You have reached the limit of {{draftMaxCount}} drafts.", "storyboard.errorMessaging.message.draftLimitError", undefined, true),{draftMaxCount:d.in}).join(""),blocking:!0};case"STORY_PIN_TOO_MANY_MULTI_UPLOADS_AT_ONCE":return{dispatchId:e,id:"STORY_PIN_TOO_MANY_MULTI_UPLOADS_AT_ONCE",type:"error",message:(0,a.nk)(i.bt("Naraz możesz przesłać tylko tyle wersji roboczych:{{multiUploadMaxCount}}.", "You can only upload {{multiUploadMaxCount}} drafts at once.", "storyboard.errorMessaging.message.multiUploadMaxError", undefined, true),{multiUploadMaxCount:d.Af}).join(""),blocking:!0};case"STORY_PIN_TITLE_MISSING":return{dispatchId:e,id:"STORY_PIN_TITLE_MISSING",type:"error",message:l?i.bt("Nadaj tytuł Pinowi, zanim go opublikujesz.", "Give your Pin a title before you publish", "storyPinBuilder.errorMessaging.storyPinTitleMissing", undefined, true):i.bt("Nadaj tytuł Pinowi z pomysłem, zanim go opublikujesz", "Give your Idea Pin a title before you publish", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_VIDEO_BELOW_MIN_DURATION":{let t=Math.floor(s.W_);return{dispatchId:e,id:"STORY_PIN_VIDEO_BELOW_MIN_DURATION",type:"error",message:(0,a.nk)(i.nbt(["Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} s.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} s.", "Ten film jest zbyt krótki i nie można go przesłać. Minimalna długość filmu to {{minVideoLengthSeconds}} s."], t, "storyPinBuilder.errorMessaging.message", true),{minVideoLengthSeconds:t}).join(""),blocking:!0}}case"STORY_PIN_VIDEO_ON_COVER":return{dispatchId:e,id:"STORY_PIN_VIDEO_ON_COVER",type:"error",message:i.bt("Strona okładki nie może zawierać filmu", "The cover page cannot contain a video", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0};case"STORY_PIN_VIDEO_OVER_MAX_FILE_SIZE":{let t=s.Lr/1024/1024;return{dispatchId:e,id:"STORY_PIN_VIDEO_OVER_MAX_FILE_SIZE",type:"error",message:(0,a.nk)(i.nbt(["Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB.", "Ten film ma zbyt duży rozmiar i nie można go przesłać. Maksymalny rozmiar filmu to {{maxVideoFileSize}} MB."], t, "storyPinBuilder.errorMessaging.message", true),{maxVideoFileSize:t}).join(""),blocking:!0}}case"ALT_TEXT_OVER_MAX_CHARACTER_LIMIT":return{dispatchId:e,id:"ALT_TEXT_OVER_MAX_CHARACTER_LIMIT",type:"error",message:i.bt("Ojej! Ten tekst alternatywny może okazać się zbyt długi. Spróbuj go skrócić.", "Ooops! This alt text is getting long. Try trimming it down.", "pinBuilder.errorMessaging.message", undefined, true)};default:return{dispatchId:e,id:"GENERAL_ERROR",type:"error",message:i.bt("Coś poszło nie tak. Spróbuj ponownie.", "Hmm, something went wrong. Please try again.", "storyPinBuilder.errorMessaging.message", undefined, true),blocking:!0}}}function h(e,t,i){i({event_type:7564,view_type:212,component:(0,l.Z)().includes("create")?13762:13308,aux_data:{error_message:t,error_id:e}})}},599965:(e,t,i)=>{"use strict";i.d(t,{Z:()=>a});var r=i(625303);function a(e,t){let{layout:i}=t||{},{sections:a}=i||{},{media:s}=(a&&1===a.length?a[0]:{})||{},{viewbox:o,angle:n,width:l,height:_}=s||{},d={},u=!1;if(o){let t=Math.round(o.width*l),i=Math.round(o.height*_),a=Math.round(o.left*l-t/2),s=Math.round(o.top*_-i/2),c=n||0;d={origin_x:a,origin_y:s,width:t,height:i,rotation:c},u=a>Number.EPSILON||s>Number.EPSILON||1-o.width>Number.EPSILON||1-o.height>Number.EPSILON||0!==c;let p=e.duration?e.duration:0,h=e.trimmedStartTime?e.trimmedStartTime:0,g=e.trimmedEndTime?e.trimmedEndTime:p;return d={...d,time_start:(0,r.TA)(h),time_end:(0,r.TA)(g)},(u=u||h>Number.EPSILON||p-g>.01)?d:null}return null}},100813:(e,t,i)=>{"use strict";i.d(t,{B:()=>s,v:()=>a});var r=i(953565);function a(e,t,i){return new Promise(a=>{let s;let o=document.createElement("video"),n=()=>{let e=o.seekable.length;e&&o.seekable.end(e-1)>=t&&(window.clearInterval(s),o.currentTime=t)},l=0,_=()=>{s=window.setInterval(n,50)},d=()=>{o.removeEventListener("loadedmetadata",_);let{x:s,y:n,width:u,height:c}=i||{x:0,y:0,width:o.videoWidth,height:o.videoHeight},p=document.createElement("canvas");if(p.height=c,p.width=u,p.getContext("2d").drawImage(o,s,n,p.width,p.height,0,0,p.width,p.height),function(e){let{height:t,width:i}=e;return new Uint32Array(e.getContext("2d").getImageData(0,0,i,t).data.buffer).filter(e=>4294967295!==e).length/(i*t)<.005}(p)&&l<5){l+=1,o.addEventListener("loadedmetadata",_),o.src=e.src,o.load();return}if(l>0){let{duration:i,id:a,name:s,signature:o,size:n}=e;(0,r.nP)("storypin.publish.thumbnail.isblank",{sampleRate:1,tags:{duration:i,id:a,name:s,signature:o,size:n,time:t,retrySeekNumber:l}})}o.removeEventListener("seeked",d),o.remove(),a(p.toDataURL("image/jpeg",1))};o.addEventListener("loadedmetadata",_),o.addEventListener("seeked",d),o.src=e.src})}function s(e,t){return new Promise(i=>{let r=document.createElement("img");r.onload=function(){let{x:e,y:a,width:s,height:o}=t||{x:0,y:0,width:r.width,height:r.height},n=document.createElement("canvas");n.height=o,n.width=s,n.getContext("2d").drawImage(r,e,a,n.width,n.height,0,0,n.width,n.height),i(n.toDataURL("image/jpeg",1))},r.src=e})}},132545:(e,t,i)=>{"use strict";i.d(t,{DY:()=>S,J6:()=>B,Oc:()=>b,f5:()=>V,gn:()=>T,qi:()=>A,x:()=>x});var r=i(172045),a=i(216167),s=i(509550),o=i(203966),n=i(984234),l=i(288240),_=i(827625),d=i(747602),u=i(622350),c=i(253084),p=i(980162),h=i(555998),g=i(953565);let m=e=>e.reduce((e,t)=>e.concat(t),[]);function I(e,t){let{pinItemIds:i,pinItemIndex:r}=e.pinbuilder.pinDrafts[t];return i[r]}function E(e,t){let{pinbuilder:{pinItems:i}}=e;return i[I(e,t)]}function P(e,t,i){if(e){let r=Object.keys(e),a=[];return r.forEach(r=>{let s=Object.keys(e[r]),o=e=>(0,u.ZP)({errorId:e,i18n:t,ideaPinRenamingEnabled:i,dispatchId:r});s.length>0&&s.forEach(e=>{let t=parseInt(e,10);switch((0,g.nP)("pinbuilder.validator.signal",{sampleRate:1,tags:{errorCode:t}}),t){case 1:a.push(o("URL_UNREACHABLE"));break;case 2:a.push(o("URL_CONTAINS_PORN_DOMAIN"));break;case 304:a.push(o("IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO"));break;case 301:a.push(o("IMAGE_UNDER_MIN_DIMENSIONS"));break;case 9:a.push(o("LINK_LOADS_SLOWLY"));break;case 10:a.push(o("LINK_IS_AGGREGATOR"));break;case 305:a.push(o("IMAGE_IS_SCREENSHOT"));break;case 306:a.push(o("IMAGE_IS_BLURRY"));break;case 4:a.push(o("URL_IS_BLOCKED"))}})}),a}return[]}function f(e,t){return(i,r)=>{let{pinItems:a}=r().pinbuilder,s={},{signals:o}=a[e];switch(t){case"link_url":Object.prototype.hasOwnProperty.call(o,"URL_CONTAINS_PORN_DOMAIN")&&(s.URL_CONTAINS_PORN_DOMAIN=!1),Object.prototype.hasOwnProperty.call(o,"URL_UNREACHABLE")&&(s.URL_UNREACHABLE=!1);break;case"image_signature":Object.prototype.hasOwnProperty.call(o,"IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO")&&(s.IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO=!1),Object.prototype.hasOwnProperty.call(o,"IMAGE_UNDER_MIN_DIMENSIONS")&&(s.IMAGE_UNDER_MIN_DIMENSIONS=!1)}Object.keys(s).length>0&&i((0,c.nh)(e,{signals:s}))}}function y(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{selectedItem:a,pinIsAdsOnly:o}=s.pinbuilder.pinDrafts[e];r(o||a?null:(0,u.ZP)({errorId:"BOARD_MISSING",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}))})}}function T(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{isTaggable:a,pinTagIds:o}=E(s,e),n=o.filter(e=>"deleted"!==s.pinbuilder.pinTags[e].status),{isShowcase:l}=s.pinbuilder.pinDrafts[e];r(l&&n.length<1?(0,u.ZP)({errorId:"TAG_EMPTY",i18n:t,ideaPinRenamingEnabled:i,dispatchId:I(s,e)}):!a&&n.length>0?(0,u.ZP)({errorId:"TAG_INVALID",i18n:t,ideaPinRenamingEnabled:i,dispatchId:I(s,e)}):null)})}}function A({i18n:e,ideaPinRenamingEnabled:t,link:i,pinItemId:s,resources:l,dispatch:c,isShowcase:p,experimentsClient:h}){return new Promise(g=>{let m=s||(0,r.Z)();if(i){if((0,d.CB)(i,h)){if(i.length>o.cH)g([(0,u.ZP)({errorId:"URL_IS_TOO_LONG",i18n:e,ideaPinRenamingEnabled:t,dispatchId:m})]);else if(n.Z.enabled("linkStatusValidation")){let r="PinCreationQualitySignalResource",s={pin_items:{[m]:{link_url:i}}};l&&l[r]&&l[r][i]?g(P({[m]:l[r][i]},e,t)):a.Z.create(r,s).callGet().then(a=>{let{data:o}=a.resource_response;!function(e,t,i){if(t){let r=i[Object.keys(i)[0]];e&&(e.PinCreationQualitySignalResource={...e.PinCreationQualitySignalResource,[t]:r})}}(l,i,o),c&&c((0,_.Sr)(r,s,a)),g(P(o,e,t))}).catch(()=>g(null))}else g(null)}else g([(0,u.ZP)({errorId:"URL_INVALID",i18n:e,ideaPinRenamingEnabled:t,dispatchId:m})])}else n.Z.enabled("requireLink")&&!p?g([(0,u.ZP)({errorId:"URL_MISSING",i18n:e,ideaPinRenamingEnabled:t,dispatchId:m})]):g(null)})}function b(e,t,i){return(r,a)=>{let{pinbuilder:s,resources:o}=a(),{pinDrafts:n,pinItems:l,storyPinItems:_}=s,{pinItemIds:d,type:u,isShowcase:c}=n[e];return d.filter(e=>"carousel"!==u||!!l[e].media).map(e=>("story"!==u&&r(f(e,"link_url")),A({i18n:t,ideaPinRenamingEnabled:i,link:"story"===u?_[e].linkBlock&&_[e].linkBlock.srcUrl:l[e].link,pinItemId:e,resources:o,dispatch:r,isShowcase:c})))}}function S(e,t,i,r){return(s,o)=>{let{pinbuilder:n,resources:d}=o(),{pinDrafts:u,pinItems:c,storyPinItems:p}=n,{pinItemIds:h,type:g}=u[e],m="PinCreationQualitySignalResource";if("story"===g)return Promise.resolve([]);let I={pin_items:h.reduce((e,t)=>{let r="story"===g,{title:a,description:s,media:o}=r?p[t]:c[t],n=r?p[t].linkBlock.srcUrl:c[t].link;return{...e,[t]:{title:a,description:s,image_signature:o&&"localImage"===o.type?o.signature:"",link_url:n,fields_to_check:[i]}}},{})},E=(0,l.Z)(I);if(!d||!d[m]||!d[m][E])return new Promise(e=>{a.Z.create(m,I).callGet().then(a=>{let{data:o}=a.resource_response;return h.map(e=>s(f(e,i))),s((0,_.Sr)(m,I,a)),e(P(o,t,r))}).catch(()=>e([]))});{let{data:e}=d[m][E];return h.map(e=>s(f(e,i))),Promise.resolve(P(e,t,r))}}}function R(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{r((0,p.q7)(s,{pinDraftId:e}).filter(e=>null!==e.media).length<o.fk?(0,u.ZP)({errorId:"STORY_PIN_NOT_ENOUGH_PAGES",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}):null)})}}function O(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{r(0===(0,p.q7)(s,{pinDraftId:e}).filter(e=>!!e.blockIds.length).length?(0,u.ZP)({errorId:"STORY_PIN_NOT_ENOUGH_PAGES",i18n:t,ideaPinRenamingEnabled:i}):null)})}}function N(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let a=(0,p.pq)(s,{pinDraftId:e});return r(1!==(0,h.yp)(s,{pinItemId:a[0]}).filter(e=>("story_pin_image_block"===e.type||"story_pin_video_block"===e.type)&&!!e.media).length?(0,u.ZP)({errorId:"STORY_PIN_COVER_PAGE_IMAGE_MISSING",i18n:t,ideaPinRenamingEnabled:i}):null)})}}function D(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>r((0,p.pc)(s,{pinDraftId:e})?null:(0,u.ZP)({errorId:"STORY_PIN_TITLE_MISSING",i18n:t,ideaPinRenamingEnabled:i})))}}let v=[y,b,function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{type:a}=s.pinbuilder.pinDrafts[e],{media:o}=E(s,e);r("carousel"===a?null:o?null:(0,u.ZP)({errorId:"MEDIA_MISSING",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}))})}},T,function(e,t,i){return(r,a)=>{let n=a();return new Promise(r=>{let{publishOption:a,scheduledDate:l}=n.pinbuilder.pinDrafts[e],_=new Date;_.setHours(0,0,0,0),"publish-immediately"!==a&&(l?l<_?r((0,u.ZP)({errorId:"DATE_IN_PAST",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e})):l>(0,s.Z)(new Date,o.TZ)&&r((0,u.ZP)({errorId:"DATE_TOO_FAR_IN_FUTURE",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e})):r((0,u.ZP)({errorId:"DATE_MISSING",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}))),r(null)})}},function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{publishOption:a,scheduledTime:o}=s.pinbuilder.pinDrafts[e];r("publish-immediately"===a||o?null:(0,u.ZP)({errorId:"TIME_MISSING",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}))})}}],M=[y,b,function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{pinItemIds:a}=s.pinbuilder.pinDrafts[e],{canvasJson:o}=s.pinbuilder.storyPinItems[a[0]];r(o&&o.aspectRatio&&9===o.aspectRatio.w&&16===o.aspectRatio.h?null:(0,u.ZP)({errorId:"STORY_PIN_COVER_PAGE_INVALID_ASPECT_RATIO",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}))})}},function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{pinItemIds:a}=s.pinbuilder.pinDrafts[e],{media:o}=s.pinbuilder.storyPinItems[a[0]];r(o&&"localVideo"===o.type?(0,u.ZP)({errorId:"STORY_PIN_VIDEO_ON_COVER",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e}):null)})}},function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let{pinItemIds:a}=s.pinbuilder.pinDrafts[e],{title:o}=s.pinbuilder.storyPinItems[a[0]];o||r((0,u.ZP)({errorId:"STORY_PIN_COVER_PAGE_TITLE_MISSING",i18n:t,ideaPinRenamingEnabled:i,dispatchId:e})),r(null)})}},R],C=[y,N,O,D],U=(e,t)=>{let{pinItemIds:i}=e.pinbuilder.pinDrafts[t];return(i.length?e.pinbuilder.storyPinItems[i[0]]:{}).blockIds.length?C:M},L=[y,b,R],w=[y,N,O,D],k=(e,t)=>{let{pinItemIds:i}=e.pinbuilder.pinDrafts[t];return(i.length?e.pinbuilder.storyPinItems[i[0]]:{}).blockIds.length?w:L},z=[function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let a=(0,p.uO)(s,{pinDraftId:e}),o=!1;for(let e=0;e<a.length;e+=1)if(a[e].media?.type){let t;let{media:i}=a[e];switch(i.type){case"localImage":t=i.signatureEdited;break;case"localVideo":t=void 0===i.trimmedEndTime||void 0===i.trimmedStartTime||0===i.trimmedStartTime&&i.trimmedEndTime===i.duration?i.signature:i.signatureEdited;break;case"webImage":case"webVideo":t=i.signature}if(!t){o=!0;break}}return r(o?(0,u.ZP)({errorId:"STORY_PIN_MEDIA_SIGNATURES_MISSING",i18n:t,ideaPinRenamingEnabled:i}):null)})}},function(e,t,i){return(r,a)=>{let s=a();return new Promise(r=>{let a=s.pinbuilder.pinDrafts[e].pinItemIds[0];return r(s.pinbuilder.storyPinItems[a].coverImgSignature?null:(0,u.ZP)({errorId:"STORY_PIN_COVER_PAGE_SIGNATURE_MISSING",i18n:t,ideaPinRenamingEnabled:i}))})}}],F=(e,t)=>{let{pinItemIds:i}=e.pinbuilder.pinDrafts[t];return(i.length?e.pinbuilder.storyPinItems[i[0]]:{}).blockIds.length?z:[]};function x(e,t,i){return(r,a)=>{let s=a(),{type:o}=s.pinbuilder.pinDrafts[e];return Promise.all(m([..."story"===o?U(s,e):v].map(a=>r(a(e,t,i))))).then(e=>m(e.filter(Boolean)))}}function B(e,t,i){return(r,a)=>{let s=a(),{type:o}=s.pinbuilder.pinDrafts[e];return Promise.all(m([..."story"===o?k(s,e):v].map(a=>r(a(e,t,i))))).then(e=>m(e.filter(Boolean)))}}function V(e,t,i){return(r,a)=>{let s=a(),o=s.pinbuilder.pinDrafts[e];return Promise.all(m([...s.pinbuilder.storyPinItems[o.pinItemIds[0]].blockIds.length>0?F(s,e):[]].map(a=>r(a(e,t,i))))).then(e=>m(e.filter(Boolean)))}}},281871:(e,t,i)=>{"use strict";function r(e,t,i){return{privacy_filter:t?"secret":"public",sort:i||"last_pinned_to",field_set_key:"profile_grid_item",username:e}}i.d(t,{Z:()=>r})},945488:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});let r=(e,t)=>`${e}:${t||""}`},885837:(e,t,i)=>{"use strict";i.d(t,{O:()=>n,Q:()=>l});var r=i(827625),a=i(945488),s=i(64819);let o=["alphabetical","last_pinned_to","oldest","newest","group_boards_at_top","custom"],n={name:"BoardsResource",key:"boardsResource",options:({boardOrder:e,filterStories:t,mixPublicSecret:i,username:r,privacyFilter:a="all",filterAllPins:s=!1,filterShoppingList:o=!1,includeArchived:n=!0},l)=>({privacy_filter:a,sort:e||"last_pinned_to",field_set_key:"profile_grid_item",filter_stories:t,username:r,page_size:25,group_by:i?"mix_public_private":"visibility",include_archived:n,redux_normalize_feed:!0,filter_all_pins:s,filter_shopping_list:o,...l?{orbac_subject_id:l}:Object.freeze({})})},l=e=>o.reduce((t,i)=>{let o=[(0,s.N8)("profileBoards",(0,a.Z)(e,i))];return[!0,!1].forEach(t=>{[!0,!1].forEach(a=>{o.push((0,r.jB)(n.name,n.options({username:e,boardOrder:i,mixPublicSecret:t,filterStories:a})))})}),t.concat(o)},[])},821419:(e,t,i)=>{"use strict";i.d(t,{Br:()=>p,Cr:()=>R,K8:()=>P,L1:()=>w,Tq:()=>I,YQ:()=>L,YV:()=>S,ZP:()=>O,aX:()=>N,eo:()=>g,fJ:()=>z,md:()=>h,oG:()=>m,oL:()=>D,of:()=>f,xH:()=>E,xQ:()=>y,xR:()=>U,xk:()=>A,yT:()=>c,zS:()=>k});var r=i(216167),a=i(481177),s=i(372085),o=i(227258),n=i(827625),l=i(281871),_=i(885837),d=i(64819),u=i(937310);function c(e){return{type:"BOARD_UPDATE_COMPLETE",payload:{board:e}}}function p(e){return{type:"BOARD_PIN_COUNT_CHANGED",payload:e}}function h(e,t){return{type:"BOARD_FOLLOW",payload:{boardId:e,value:t}}}function g({viewingUserId:e,viewingUsername:t,boardId:i,boardPinCount:r}){return{type:"BOARD_DELETE",payload:{viewingUserId:e,viewingUsername:t,boardId:i,boardPinCount:r}}}let m=(e,t)=>i=>i((0,o.U)("BoardResource",{options:{board_id:e,field_set_key:t}}));function I(e,t,i){return(0,o.U)("BoardResource",{options:{board_id:e,field_set_key:t,...i?{orbac_subject_id:i}:{}}})}function E(e,t,i){return r=>(0,s.Z)({url:`/v3/boards/${e}/merge/${t}/`,method:"POST",data:i?{orbac_subject_id:i}:{}}).then(()=>Promise.all([r(g({boardId:e})),r(I(t,"pin_count")),r((0,d.N8)(u.Z.BOARD_SECTIONS,t))]))}function P(e){return t=>{e&&(0,_.Q)(e).forEach(e=>{t(e)})}}let f=e=>({type:"BOARD_DISMISS_SENSITIVITY_SCREEN",payload:{boardId:e}}),y=e=>m(e,"pin_count");function T(e,t){return{type:"BOARD_ARCHIVE",payload:{boardId:e,username:t}}}function A(e,t){return i=>(i(T(e)),r.Z.create("BoardArchiveResource",{boardId:e,orbacSubjectId:t}).callUpdate())}function b(e){return{type:"BOARD_UNARCHIVE",payload:{boardId:e}}}function S(e,t){return i=>(i(b(e)),r.Z.create("BoardArchiveResource",{boardId:e,orbacSubjectId:t}).callDelete())}let R=(e,t)=>({type:"BOARD_COVER_IMAGE_UPDATED",payload:{boardId:e,coverPin:t}}),O=e=>({type:"BOARD_DISABLE_MORE_IDEAS_BADGING",payload:{boardId:e}});function N(e,t,i){let s={name:e,privacy:a.Z.BoardPrivacy.PUBLIC,username:t,...i?{orbac_subject_id:i}:Object.freeze({})};return e=>r.Z.create("BoardResource",s).callCreate().then(i=>{let r=i.resource_response.data;return e(t&&(0,n.jB)("BoardsResource",(0,l.Z)(t,!1))),r})}function D(e={},t,i){return{type:"BOARD_CREATE_COMPLETE",payload:{options:e,board:t},error:i}}let v=(e,t)=>({type:"BOARD_INVITE_DENIED_BY_VIEWER",payload:{boardId:e,userId:t}}),M=(e,t,i)=>({type:"BOARD_COLLABORATOR_DELETE",payload:{boardId:e,userId:t,viewingUser:i}}),C=(e,t,i,r)=>({type:"BOARD_COLLABORATOR_ADD",payload:{boardId:e,viewingUser:t,status:i,collaboratingUsers:r}}),U=(e,t,i)=>async a=>{a(v(e,t));let s=await r.Z.create("BoardInviteResource",{board_id:e,invited_user_id:t}).callDelete();return s.resource_response.error||i({event_type:29,object_id_str:e}),s},L=(e,t,i,a,s,o)=>async n=>{n(M(e,a?.id??"",i));try{(await r.Z.create("accepted"===t?"BoardCollaboratorResource":"BoardInviteResource",{board_id:e,field_set_key:"boardEdit",invited_user_id:a?.id??"",...o?{orbac_subject_id:o}:{}}).callDelete()).resource_response.error||s({event_type:"accepted"===t?25:29,object_id_str:e})}catch(r){n(C(e,i,t,[a]))}},w=(e,t,i,a)=>s=>{let o=r.Z.create("BoardResource",{board_id:i}).callDelete();return s(g({viewingUserId:e,viewingUsername:t,boardId:i,boardPinCount:a})),o},k=(e,t)=>i=>r.Z.create("BoardArchiveResource",{boardId:e}).callUpdate().then(r=>(i((0,d.Qv)("archived-boards",[{id:e,type:"board"}])),i(T(e,t)),r)),z=(e,t)=>i=>r.Z.create("BoardArchiveResource",{boardId:e}).callDelete().then(r=>(i((0,d.Qv)(`profile-boards:${t}`,[{id:e,type:"board"}])),i(b(e)),r))},64819:(e,t,i)=>{"use strict";function r(e){return{type:"FEED_ITEM_REORDERED",payload:e}}function a(e,t){return{type:"FEED_INVALIDATE",payload:{feedType:e,feedId:t}}}i.d(t,{EX:()=>o,N8:()=>a,Qv:()=>s,_f:()=>r,vX:()=>n});let s=(e,t,i=Object.freeze({}))=>({type:"APPEND_FEED_ITEMS",payload:{id:e,options:i,items:t}});function o(e){return{type:"FEED_ITEMS_REMOVED",payload:e}}function n(e){return{type:"FEED_ITEMS_ADDED",payload:e}}},486595:(e,t,i)=>{"use strict";function r(e,t){return{type:"PIN_BUILDER_REMOVE_PIN_ITEM_UPLOAD",payload:{pinDraftId:e,pinItemId:t}}}function a(e){return{type:"PIN_BUILDER_REMOVE_PIN_DRAFT_UPLOAD",payload:{pinDraftId:e}}}function s(e,t){return(i,s)=>{let{pinDraftIdUploadStatusMap:o}=s().pinbuilder,n=o[e];n&&n.items[t]&&n.items[t].xhr&&(n.items[t].xhr.abort(),i(Object.keys(n.items).length<=1?a(e):r(e,t)))}}i.d(t,{$Z:()=>s,su:()=>r,y2:()=>a})},41227:(e,t,i)=>{"use strict";function r(e){return{type:"PIN_BUILDER_ADD_CREATED_PIN_ID",payload:{pinId:e}}}i.d(t,{F:()=>r})},98974:(e,t,i)=>{"use strict";function r(e,t,i){return{type:"PIN_BUILDER_ADD_PIN_DRAFT",payload:{pinDraftId:e,pinDraft:t,options:i}}}i.d(t,{Z:()=>r})},228554:(e,t,i)=>{"use strict";function r(e,t,i,r){return{type:"PIN_DRAFT_ADD_PIN_ITEM",payload:{pinDraftId:e,pinItemId:t,pinItem:i,options:r}}}i.d(t,{Z:()=>r})},84442:(e,t,i)=>{"use strict";function r(e,t,i){return{type:"PIN_ITEM_ADD_PIN_TAG",payload:{pinItemId:e,pinTagId:t,pinTag:i}}}i.d(t,{Z:()=>r})},305138:(e,t,i)=>{"use strict";function r(e,t,i){return{type:"PIN_TAG_ADD_TAGGED_OBJECT",payload:{pinTagId:e,taggedObjectId:t,taggedObject:i}}}i.d(t,{Z:()=>r})},461738:(e,t,i)=>{"use strict";i.r(t),i.d(t,{_isPristine:()=>T,addPinBuilderAsset:()=>y,addPinBuilderPinDraftItemUpload:()=>S,clearCreatedPinIds:()=>D,clearPinBuilderPinDrafts:()=>c,clearSelectedPinBuilderPinDrafts:()=>m,deselectAllPinBuilderPinDrafts:()=>P,deselectPinBuilderPinDraft:()=>g,duplicatePinDraft:()=>p,removeCreatedPinId:()=>N,selectAllPinBuilderPinDrafts:()=>I,selectAllPinBuilderStoryPinDrafts:()=>E,selectPinBuilderPinDraft:()=>h,setCloseupImageSignature:()=>v,setPinBuilderBatchEditMode:()=>A,setPinBuilderEntryPoint:()=>M,setPinBuilderPinItemUploadStatus:()=>R,setPinBuilderPinItemUploadXhr:()=>O,setPinBuilderSharedData:()=>f,setPinEditorPinDraft:()=>b,setShowDisabledPinCreationBanner:()=>U,setShowFeedbackModal:()=>C});var r=i(172045),a=i(203966),s=i(98974),o=i(228554),n=i(474052),l=i(391404),_=i(276909),d=i(204595),u=i(980162);function c(){return{type:"PIN_BUILDER_CLEAR_PIN_DRAFTS"}}function p(e,t,i){return(a,n)=>{let{pinDrafts:u,pinItems:c,storyPinItems:p,storyPinItemBlocks:h}=n().pinbuilder,g=u[e],m=(0,r.Z)(),I=g.pinItemIds.map(s=>{let n=(0,r.Z)();if(c[s])a((0,o.Z)(m,n,c[s]));else if(p[s]){let o=p[s],u=o.blockIds.map(e=>h[e]);a((0,_.Z)({i18n:t,isEmployee:i,pinDraftId:e,storyPinPublishStopwatch:void 0})),a((0,l.Z)(m,n,{...o,blockIds:[]})),u.forEach(t=>{a((0,d.Uo)(e,n,(0,r.Z)(),{...t}))})}return n});return a((0,s.Z)(m,{...g,pinItemIds:I,storyPinDraftId:null},{insertBefore:e})),m}}function h(e){return{type:"PIN_BUILDER_SELECT_PIN_DRAFT",payload:{pinDraftId:e}}}function g(e){return{type:"PIN_BUILDER_DESELECT_PIN_DRAFT",payload:{pinDraftId:e}}}function m(){return{type:"PIN_BUILDER_CLEAR_SELECTED_PIN_DRAFTS"}}function I(){return(e,t)=>{let{pinbuilder:i}=t(),{selectedPinDraftIds:r,pinDrafts:s,pinDraftIds:o}=i;o.forEach(t=>{let{status:i}=s[t];r.includes(t)||a.x1.includes(i)||e(h(t))})}}function E(){return(e,t)=>{let i=t(),{pinbuilder:r}=i,{selectedPinDraftIds:s}=r,o=(0,u.Wp)(i);Object.keys(o).forEach(t=>{let{status:i,storyPinDraftId:r}=o[t];r&&t&&!s.includes(t)&&!a.x1.includes(i)&&e(h(t))})}}function P(){return(e,t)=>{let{pinbuilder:i}=t(),{selectedPinDraftIds:r}=i;r.forEach(t=>{e(g(t))})}}function f(e){return(t,i)=>{let{selectedPinDraftIds:a}=i().pinbuilder,{publishOption:s,scheduledDate:o,scheduledTime:l,selectedItem:_,...d}=e;a.forEach(e=>{t((0,n.NA)(e,{...null!=s?{publishOption:s}:Object.freeze({}),...void 0!==_?{selectedItem:_}:Object.freeze({}),...void 0!==o?{scheduledDate:o}:Object.freeze({}),...void 0!==l?{scheduledTime:l}:{}})),d.editorInstanceId=(0,r.Z)(),t((0,n.to)(e,d))})}}function y(e){return{type:"PIN_BUILDER_ADD_ASSET",payload:{asset:e}}}function T(e,t){let{pinDrafts:i,pinItems:r}=e.pinbuilder,{selectedItem:a,pinItemIds:s,publishOption:o}=i[t];return!a&&"publish-immediately"===o&&s.every(e=>{let{description:t,link:i,media:a,title:s}=r[e];return!t&&!i&&!s&&!a})}function A(e){return{type:"PIN_BUILDER_SET_BATCH_EDIT_MODE",payload:{isBatchEditMode:e}}}function b(e){return{type:"PIN_EDITOR_SET_PIN_DRAFT",payload:{editedPinDraftId:e}}}function S(e,t,i){return{type:"PIN_BUILDER_ADD_PIN_DRAFT_ITEM_UPLOAD",payload:{pinDraftId:e,pinItemId:t,upload:i}}}function R(e,t,i){return{type:"PIN_BUILDER_SET_PIN_ITEM_UPLOAD_STATUS",payload:{pinDraftId:e,pinItemId:t,status:i}}}function O(e,t,i){return{type:"PIN_BUILDER_SET_PIN_ITEM_UPLOAD_XHR",payload:{pinDraftId:e,pinItemId:t,xhr:i}}}function N(e){return{type:"PIN_BUILDER_REMOVE_CREATED_PIN_ID",payload:{pinId:e}}}function D(){return{type:"PIN_BUILDER_CLEAR_CREATED_PIN_IDS"}}function v(e){return{type:"PIN_BUILDER_SET_CLOSEUP_IMAGE_SIGNATURE",payload:{closeupImageSignature:e}}}function M(e){return{type:"PIN_BUILDER_ENTRY_POINT",payload:{entryPoint:e}}}function C(e){return{type:"PIN_BUILDER_SHOW_FEEDBACK_MODAL",payload:{showFeedbackModal:e}}}function U(e){return{type:"PIN_BUILDER_SHOW_DISABLE_PIN_CREATION_BANNER",payload:{showDisabledPinCreationBanner:e}}}},474052:(e,t,i)=>{"use strict";i.d(t,{$K:()=>Z,$k:()=>eI,BG:()=>v,By:()=>eP,Cj:()=>q,DL:()=>eh,Fu:()=>ek,Fz:()=>Q,GX:()=>ea,I0:()=>V,Ig:()=>em,Jr:()=>ev,KF:()=>eL,KN:()=>eg,KT:()=>H,N$:()=>X,NA:()=>ey,Nv:()=>z,QZ:()=>j,Qc:()=>et,R6:()=>K,RR:()=>B,Si:()=>eM,TD:()=>w,Ug:()=>ed,Ve:()=>Y,WE:()=>eN,WT:()=>eO,Wo:()=>W,XB:()=>ei,YN:()=>e_,YY:()=>el,Yr:()=>G,_B:()=>$,_e:()=>eT,c8:()=>M,c_:()=>ec,cr:()=>eu,dI:()=>ee,dj:()=>en,e5:()=>C,ej:()=>J,f9:()=>eo,hb:()=>ep,iX:()=>eC,kp:()=>ef,lT:()=>k,m_:()=>ew,n6:()=>L,p3:()=>U,q0:()=>eE,qF:()=>er,rS:()=>F,th:()=>eU,to:()=>eb,u9:()=>eA,vS:()=>eR,xb:()=>x,z0:()=>eD});var r=i(172045),a=i(216167),s=i(203966),o=i(984234),n=i(879543),l=i(18769),_=i(827625),d=i(622350),u=i(599965),c=i(100813),p=i(578278),h=i(821419),g=i(64819),m=i(486595),I=i(41227),E=i(98974),P=i(228554),f=i(253084),y=i(10540),T=i(727812),A=i(960671),b=i(884308),S=i(744807),R=i(686387),O=i(386129),N=i(937310);function D(e,t,i,r){return(0,d.ZP)({errorId:e,i18n:t,ideaPinRenamingEnabled:r,dispatchId:i})}function v(){return{type:"PIN_DRAFT_CLEAR_STATE"}}function M(e,t){return{type:"PIN_DRAFT_SET_VIEW",payload:{pinDraftId:e,view:t}}}function C(e,t){return{type:"PIN_DRAFT_SET_CREATE_METHOD",payload:{pinDraftId:e,createMethod:t}}}function U(e,t){return{type:"PIN_DRAFT_SET_STATUS",payload:{pinDraftId:e,status:t}}}function L(e,t){return{type:"PIN_DRAFT_SET_PUBLISHING_STATUS",payload:{pinDraftId:e,publishingStatus:t}}}function w(e,t){return{type:"PIN_DRAFT_SET_IS_AD_INELIGIBLE",payload:{pinDraftId:e,isAdIneligible:t}}}function k(e,t,i){return{type:"PIN_DRAFT_SET_API_ERROR",payload:{pinDraftId:e,apiError:t,apiErrorCode:i}}}function z(e,t){return{type:"PIN_DRAFT_SET_SELECTED_ITEM",payload:{pinDraftId:e,selectedItem:t}}}function F(e,t){return{type:"PIN_DRAFT_SET_ADS_ONLY_STATUS",payload:{pinDraftId:e,pinIsAdsOnly:t}}}function x(e,t){return{type:"PIN_DRAFT_SET_BOARD_ERROR",payload:{pinDraftId:e,boardError:t}}}function B(e,t){return{type:"PIN_DRAFT_SET_PUBLISH_OPTION",payload:{pinDraftId:e,publishOption:t}}}function V(e,t){return{type:"PIN_DRAFT_SET_SCHEDULED_DATE",payload:{pinDraftId:e,scheduledDate:t}}}function G(e,t){return{type:"PIN_DRAFT_SET_SCHEDULED_DATE_ERROR",payload:{pinDraftId:e,scheduledDateError:t}}}function Z(e,t){return{type:"PIN_DRAFT_SET_SCHEDULED_TIME",payload:{pinDraftId:e,scheduledTime:t}}}function Y(e,t){return{type:"PIN_DRAFT_SET_SCHEDULED_TIME_ERROR",payload:{pinDraftId:e,scheduledTimeError:t}}}function j(e,t){return{type:"PIN_DRAFT_SET_LAST_EDITED_TIME",payload:{pinDraftId:e,lastEditedTime:t}}}function H(e,t){return{type:"PIN_DRAFT_SET_LAST_SAVED_TIME",payload:{pinDraftId:e,lastSavedTime:t}}}function $(e,t){return{type:"PIN_DRAFT_SET_MEDIA_ERROR",payload:{pinDraftId:e,mediaError:t}}}function q(e,t){return{type:"PIN_DRAFT_SET_PIN_ITEM_INDEX",payload:{pinDraftId:e,pinItemIndex:t}}}function X(e,t){return{type:"PIN_DRAFT_SET_PIN_ID",payload:{pinDraftId:e,pinId:t}}}function K(e,t){return{type:"PIN_DRAFT_SET_SCHEDULED_PIN",payload:{pinDraftId:e,scheduledPin:t}}}function W(e,t){return{type:"PIN_DRAFT_SET_STORY_PIN",payload:{pinDraftId:e,storyPin:t}}}function J(e,t){return{type:"PIN_DRAFT_SET_STORY_PIN_DRAFT_ID",payload:{pinDraftId:e,storyPinDraftId:t}}}function Q(e,t){return{type:"PIN_DRAFT_UPDATE_STORY_PIN_METADATA",payload:{pinDraftId:e,storyPinMetadata:t}}}function ee(e,t){return{type:"PIN_DRAFT_SET_IS_COMMENTS_ALLOWED",payload:{pinDraftId:e,isCommentsAllowed:t}}}function et(e,t){return{type:"PIN_DRAFT_SET_IS_SHOPPING_REC_ALLOWED",payload:{pinDraftId:e,isShoppingRecAllowed:t}}}function ei(e,t){return{type:"PIN_DRAFT_SET_PIN_ITEM_IDS",payload:{pinDraftId:e,pinItemIds:t}}}function er(e,t){return{type:"PIN_DRAFT_SET_STORY_PIN_SELECTED_PIN_ITEM_IDS",payload:{pinDraftId:e,pinItemIds:t}}}function ea(e){return{type:"PIN_DRAFT_RESET_STORY_PIN_SELECTED_PIN_ITEM_IDS",payload:{pinDraftId:e}}}function es(e,t){return{type:"PIN_DRAFT_SET_URL_CREATION_SOURCE",payload:{pinDraftId:e,urlCreationSource:t}}}function eo(e,t,i,r){return{type:"PIN_DRAFT_SET_WEBSITE_LINK",payload:{pinDraftId:e,websiteLink:t,websiteDefaultImageUrl:r,error:i}}}function en(e,t){return{type:"PIN_DRAFT_ADD_WEBSITE_MEDIA",payload:{pinDraftId:e,media:t}}}function el(e,t){return{type:"PIN_DRAFT_REMOVE_WEBSITE_MEDIA",payload:{pinDraftId:e,mediaUrl:t}}}function e_(e,t){return{type:"PIN_DRAFT_ADD_INTEREST_TAG",payload:{pinDraftId:e,tag:t}}}function ed(e,t){return{type:"PIN_DRAFT_REMOVE_INTEREST_TAG",payload:{pinDraftId:e,id:t}}}function eu(e,t){return{type:"PIN_DRAFT_SET_INTEREST_TAGS",payload:{pinDraftId:e,tags:t}}}function ec(e){return{type:"PIN_DRAFT_CLEAR_INTEREST_TAGS",payload:{pinDraftId:e}}}function ep(e){return{type:"PIN_DRAFT_CLEAR_WEBSITE_MEDIA",payload:{pinDraftId:e}}}function eh(e,t){return{type:"PIN_DRAFT_SET_ALT_TEXT",payload:{pinDraftId:e,altText:t}}}function eg(e,t){return{type:"PIN_DRAFT_SET_ALT_TEXT_ERROR",payload:{pinDraftId:e,altTextError:t}}}function em(e,t){return{type:"PIN_DRAFT_SET_SHOWCASE_BANNER_ERROR",payload:{pinDraftId:e,showcaseBannerError:t}}}function eI(e,t){return{type:"PIN_DRAFT_SET_CREATIVE_STUDIO_PIN_DATA",payload:{pinDraftId:e,creativeStudioPinParams:t}}}function eE(e,t="upload",i){return(a,s)=>{let{pinbuilder:{pinDrafts:n}}=s(),{pinItemIds:l,pinItemIndex:_,websiteLink:d,websiteMedia:u}=n[e];if(u.length>0){let t=l[_];a((0,f.mO)(t,u[0])),a((0,f.PF)(t,"webImage"===u[0].type&&u[0].sourceURL?u[0].sourceURL:d)),a((0,f.lZ)(t,null)),a(es(e,i))}u.length>1&&(o.Z.enabled("multi_pin")||o.Z.enabled("multi_pin_pinner")?u.slice(1).forEach(e=>{let t=(0,r.Z)();a((0,E.Z)(t));let s=(0,r.Z)();a((0,P.Z)(t,s,{media:e,link:"webImage"===e.type?e.sourceURL:d})),a(es(t,i))}):u.slice(1).forEach(t=>{let s=(0,r.Z)();a((0,P.Z)(e,s,{media:t,link:d})),a(es(s,i))})),a(ep(e)),a(eo(e,"")),a(M(e,t))}}function eP(e){return(t,i)=>{let{pinItemIds:r,pinItemIndex:a,websiteLink:s,websiteMedia:o}=i().pinbuilder.pinDrafts[e],n=[];if(o.length>0){let e=r[a];t((0,f.mO)(e,o[0])),t((0,f.PF)(e,"webImage"===o[0].type&&o[0].sourceURL?o[0].sourceURL:s)),t((0,f.lZ)(e,null)),o.forEach(e=>{n.push(e)})}return t(M(e,"board")),n}}function ef(e,t){return(i,a)=>{let{pinDrafts:s,pinItems:o,storyPinItems:n}=a().pinbuilder,{pinItemIds:l,type:_}=s[e],d=l.indexOf(t),u=l.length-1,c="story"===_?R.hC:f.mO;if(d===u){let{media:r}="story"===_?n[t]:o[t];r&&"webImage"===r.type&&i((0,f.PF)(t,"")),r&&"localVideo"===r.type&&i((0,m.$Z)(e,t)),i(c(t,null))}else i({type:"PIN_DRAFT_REMOVE_PIN_ITEM",payload:{pinDraftId:e,pinItemId:t}}),"carousel"===_&&o[l[u]].media&&i((0,P.Z)(e,(0,r.Z)(),null,{saveIndex:!0}))}}function ey(e,t){return{type:"PIN_DRAFT_UPDATE_DATA",payload:{pinDraftId:e,pinDraft:t}}}function eT(e,t){return{type:"PIN_DRAFT_SET_UPLOAD_START_TIME",payload:{pinDraftId:e,uploadStartTime:t}}}function eA(e,t){return(i,r)=>{let a=r(),{pinItemIds:s,pinItemIndex:o}=a.pinbuilder.pinDrafts[e];if(i({type:"PIN_DRAFT_SET_PIN_ITEM_SHAREABLE",payload:{pinDraftId:e,pinItemShareable:t}}),t){let e=s[o],{description:t,descriptionError:r,link:n,linkError:l,title:_,titleError:d}=a.pinbuilder.pinItems[e];s.forEach(e=>i((0,f.nh)(e,{description:t,descriptionError:r,link:n,linkError:l,title:_,titleError:d})))}}}function eb(e,t){return(i,r)=>{let{pinItemIds:a,pinItemIndex:s,pinItemShareable:o}=r().pinbuilder.pinDrafts[e];(o?a:[a[s]]).forEach(e=>i((0,f.nh)(e,t)))}}function eS(e,t){let i=t?(0,u.Z)(e,t):null;if(e.customCoverImg){if(i){let{origin_x:t=0,origin_y:r=0,width:a=e.width,height:s=e.height}=i;return(0,c.B)(e.customCoverImg.src,{x:t,y:r,width:a,height:s})}return Promise.resolve(e.customCoverImg.src)}if(!i)return(0,c.v)(e,e.thumbnail,null);{let{origin_x:t=0,origin_y:r=0,width:a=e.width,height:s=e.height}=i,{trimmedStartTime:o,trimmedEndTime:n,duration:l,thumbnail:_}=e,d=o||0;return(0,c.v)(e,_>=d&&_<=(n||l)?_:d,{x:t,y:r,width:a,height:s})}}function eR(e,t,i,r=2){return async(s,o)=>{let{pinbuilder:n}=o(),{pinDrafts:l}=n,{interestTags:_}=l[t],d=_.map(e=>e.id);if(d.length>0)try{await a.Z.create("InterestTaggingResource",{pinId:i,interestIds:d,zenSource:r}).callCreate(),e({event_type:8521,aux_data:{pin_id:i,story_pin_creation_id:t}})}catch(o){let{api_error_code:r,message:a,message_detail:s}=o||{};throw e({event_type:8522,aux_data:{error_message:s||a,pin_id:i,status_code:r,story_pin_creation_id:t}}),Error("Cannot add tags to the Pin.")}}}function eO(e,t){return(i,r)=>{let{pinDrafts:a}=r().pinbuilder;i(j(e,new Date)),(t||!s.qm.includes(a[e].status))&&i(U(e,"edited"))}}function eN(e,t,i,r,a,s,o){return new Promise((i,r)=>{let n;let{pinbuilder:{pinDrafts:l,pinItems:_,storyPinItems:d,storyPinItemBlocks:u}}=t,{pinItemIds:c,type:h}=l[e],g=c[0];if("story"===h){let e=d[g].blockIds.map(e=>u[e]).filter(e=>["localImage","localVideo"].includes(e.media?.type));n=e[0]?.media}else n=_[g].media;if(!n)throw Error("Invalid media");if("localImage"===n.type)(0,p.wL)(n.src,e,a,s,o).then(e=>{i({image_signature:e})}).catch(()=>{r(Error("Cannot schedule the Pin."))});else if("localVideo"===n.type){let t=n.uploadId;eS(n,null).then(t=>(0,p.wL)(t,e,a,s,o)).then(e=>i({image_signature:e,media_upload_id:t})).catch(()=>{r(Error("Cannot schedule the Pin"))})}else throw Error("Cannot upload this media type.")})}function eD(e,t,i){return(r,a)=>{let{pinDrafts:s}=a().pinbuilder,{selectedItem:o}=s[e],{board:n}=t,l=n&&n.id||o&&o.boardId;r(X(e,t.id)),r((0,h.Br)({boardId:l,sectionId:t.section?t.section.id:null,increment:1})),r((0,g.vX)({feedId:t.section?t.section.id:l,feedType:t.section?N.Z.BOARD_SECTION_PINS:N.Z.BOARDFEED,itemIds:[t.id],itemType:"pin"})),r((0,g.vX)({feedId:i,feedType:N.Z.STORY_PINS_FEED,itemIds:[t.id],itemType:"pin",prepend:!0})),r((0,O.JS)({userId:i,increment:1}))}}function ev(e){return(t,i)=>{let{pinbuilder:{pinDraftIdUploadStatusMap:r}}=i();return!!r&&!!r[e]&&"uploading"===r[e].status}}function eM(e,t,i,r){return async a=>{let s=!0;try{await a((0,A.Z)({pinDraftId:e,validationKey:"save",i18n:t,ideaPinRenamingEnabled:r,logContextEvent:i}))}catch(e){s=!1}return{pinDraftId:e,isValid:s}}}function eC({pinDraftId:e,userId:t,orbacSubjectId:i,country:r,isPartner:d,i18n:u,ideaPinRenamingEnabled:c,logContextEvent:m,checkExperiment:E,siteType:P}){return(b,R)=>{let{pinbuilder:{pinDrafts:v}}=R(),{scheduledDate:M,scheduledTime:C}=v[e];b(M&&C?function({pinDraftId:e,userId:t,i18n:i,logContextEvent:r,orbacSubjectId:n,siteType:l,ideaPinRenamingEnabled:_}){return(d,u)=>{let c=u(),{pinbuilder:{pinDrafts:p,pinItems:h}}=c;d(U(e,"publishing"));let{altText:g,pinItemIds:m,pinItemIndex:I,scheduledDate:E,scheduledTime:P,selectedItem:f}=p[e],{description:b,link:R,media:N,title:D}=h[m[I]];return d((0,A.Z)({pinDraftId:e,validationKey:"save",i18n:i,ideaPinRenamingEnabled:_,logContextEvent:r})).then(()=>{if(d(ev(e)))return o.Z.enabled("multi_pin")||o.Z.enabled("multi_pin_pinner")?(d((0,T.g)(e,"queueCreate")),d(U(e,"uploading"))):d((0,y.Z)(e)),null;if(!E||!P)throw Error("Cannot schedule a Pin without a scheduled date or time.");let _=new Date(E.getFullYear(),E.getMonth(),E.getDate(),P.getHours(),P.getMinutes(),P.getSeconds()).getTime()/1e3;return Promise.all([eN(e,c,d,i,r,n,l),_]).then(([e,t])=>{if(!f)throw Error("Cannot schedule a Pin without a board.");let i=D.substring(0,s.Ke),r=b.substring(0,s.JO),{image_signature:o,media_upload_id:l}=e,_={board:f.boardId,description:r,image_signature:o,link:R,media_upload_id:l,scheduled_timestamp:t,title:i,...g?{alt_text:g}:Object.freeze({}),...f.sectionId?{section:f.sectionId}:{},...n?{orbac_subject_id:n}:{}};return a.Z.create("ScheduledPinResource",_).callCreate()}).then(i=>{if(!N)throw Error("Cannot schedule a Pin without an image.");let{data:r}=i.resource_response;d(K(e,{...r,localMedia:N.src})),d((0,S.Tn)(r)),d((0,O.h6)({userId:n||t,increment:1})),d(U(e,"succeeded"))})}).catch(()=>{throw d(U(e,"attempted")),Error("Cannot schedule the Pin.")})}}({pinDraftId:e,userId:t,i18n:u,ideaPinRenamingEnabled:c,logContextEvent:m,orbacSubjectId:i,siteType:P}):function({checkExperiment:e,country:t,i18n:i,ideaPinRenamingEnabled:r,isPartner:d,logContextEvent:u,orbacSubjectId:c,pinDraftId:m,siteType:E,userId:P}){return async(e,b)=>{let S=b(),{pinbuilder:R}=S,{pinDrafts:v}=R,{status:M}=v[m];"uploading"!==M&&e(U(m,"publishing"));try{await e((0,A.Z)({pinDraftId:m,validationKey:"save",i18n:i,ideaPinRenamingEnabled:r,logContextEvent:u}))}catch{e(U(m,"created")),e(L(m,"clientError"));return}if(e(L(m,"publishing")),e(ev(m))){e((0,T.g)(m,"queueCreate")),e(o.Z.enabled("multi_pin")||o.Z.enabled("multi_pin_pinner")?U(m,"uploading"):(0,y.Z)(m));return}try{let r=await function(e,t,i,r,a,o,l,_,d,u){let{advertiser:c,pinbuilder:h}=t,{pinDrafts:g,pinItems:m}=h,{altText:I,pinIsAdsOnly:E,pinItemIds:P,pinItemIndex:f,selectedItem:y,type:T}=g[e];if(!E&&!y)throw Error(l.bt("Nie można utworzyć Pina bez tablicy.", "Cannot create a Pin without a board.", "pinBuilder.error.noBoard", undefined, true));if(!T)throw Error("PinBuilder Exception: Undefined PinDraft type");let A=a&&c&&(c.owner_user_id!==a||c.client_business_id)?c.id:null,b={field_set_key:"create_success",skip_pin_create_log:!0,...I?{alt_text:I}:Object.freeze({}),...y&&y.sectionId?{section:y.sectionId}:Object.freeze({}),...y&&y.boardId?{board_id:y.boardId}:Object.freeze({}),...A?{advertiser_id:A}:Object.freeze({}),...r?{orbac_subject_id:r}:Object.freeze({}),...E?{is_removable:!0,create_default_board:!0}:Object.freeze({})};return new Promise((t,a)=>{if("carousel"===T)(0,p.Ch)(P.map(e=>m[e]),e,_,u).then(e=>{t({...b,...e.metadata,carousel_data_json:{carousel_slots:e.slots}})}).catch(e=>{a(e)});else if("single"===T){let{description:d,link:c,media:h,canvasJson:I,title:E,userMentionTags:y}=m[P[f]],{creativeStudioPinParams:T}=g[e];if(!h)throw Error(l.bt("Nie można utworzyć Pina bez obrazu lub filmu.", "Cannot create a Pin without an image or video.", "pinBuilder.error.noMedia", undefined, true));let A=E.substring(0,s.Ke),S=d.substring(0,s.JO);if("localImage"===h.type)(0,p.xc)(h.src,e,_,u,r).then(({signature:e})=>{e?t({...b,image_signature:e,description:S,link:c,title:A,method:"uploaded",upload_metric:{source:(0,n.Z)(o)},user_mention_tags:y,...T&&e===T.imageSignature?{creative_studio_pin_params:{creative_studio_prompt_id:T.promptId,creative_studio_parent_pin_id:T.parentPinId,is_product_repin:T.isParentPinProductPin&&c===T.parentPinLink}}:Object.freeze({})}):a()}).catch(()=>{i($(e,l.bt("Przesyłanie nie powiodło się. Spróbuj ponownie.", "Hmm, your upload failed for some reason. Please try again.", "pinBuilder.mediaUpload.error", undefined, true))),a(Error(l.bt("Nie można utworzyć Pina, ponieważ nie udało się przesłać zdjęcia.", "Cannot create Pin because the image could not be uploaded.", "pinBuilder.error.noImageUploaded", undefined, true))),_({component:13308,event_type:15499})});else if("webImage"===h.type){let{createMethod:i}=g[e];t({...b,description:S,link:c,title:A,image_url:h.src,method:i||"scraped",scrape_metric:{source:"www_url_scrape"},user_mention_tags:y})}else if("localVideo"===h.type)eS(h,I).then(t=>(0,p.xc)(t,e,_,u)).then(({signature:e})=>{if(e)t({...b,image_signature:e,description:S,link:c,title:A,media_upload_id:h.uploadId,user_mention_tags:y});else throw Error()}).catch(()=>{i($(e,l.bt("Przesyłanie filmu nie powiodło się. Spróbuj ponownie.", "Hmm, your upload failed for some reason. Please try again.", "Error message uploading a video file and process fails", undefined, true))),a(Error(l.bt("Nie można utworzyć Pina, ponieważ nie udało się przesłać filmu.", "Cannot create Pin because the video could not be uploaded.", "pinBuilder.error.noVideoUploaded", undefined, true)))});else throw Error(l.bt("Nie można utworzyć Pina, ponieważ typ multimediów nie został rozpoznany.", "Cannot create Pin because the media type is not recognized.", "pinBuilder.error.noMediaRecognized", undefined, true))}})}(m,S,e,c,P,d,i,u,0,E),y=await a.Z.create("PinResource",r).callCreate(),{data:T}=y.resource_response;e((0,_.Sr)("PinResource",r,y)),o.Z.enabled("videoTagging")&&e(eR(u,m,T.id)),await e((e,i)=>{var a;let{pinbuilder:{pinDrafts:s}}=i();e((a=T.id,(e,t)=>{let{pinbuilder:{pinDrafts:i,pinDraftIds:r,pinItems:s,storyPinItems:n}}=t(),{pinItemIds:_,type:d,interestTags:c,urlCreationSource:p}=i[m],h=_[0],g="story"===d,{title:I,description:E,media:P}=g?n[h]:s[h],f=g?[]:s[h].userMentionTags,y=g?n[h].linkBlock&&n[h].linkBlock.srcUrl:s[h].link,T=P&&"localVideo"===P.type?"video":"image",A="single"===d?T:d,{canvasJsons:b,signals:S}=_.reduce((e,t)=>{let{canvasJson:i,signals:r}=g?n[t]:s[t],a=Object.keys(r).map(e=>({signal:e,value:r[e]}));return{canvasJsons:[...e.canvasJsons,i],signals:[...e.signals,...a]}},{canvasJsons:[],signals:[]}),R={signals:S,is_multi_pin_create:r.length>1,num_images:!!b&&Math.max(...b.map(e=>e&&e.layout?e.layout.sections.length:1))||1,text:b.reduce((e,t)=>(t&&t.text&&e.push({font_family:t.text.fontFamily,position:t.text.position,font_size:t.text.fontSize,margin:t.text.margin,bg_color:t.text.backgroundColor,bg_opacity:t.text.backgroundOpacity,text_color:t.text.textColor}),e),[]),logo:b.reduce((e,t)=>(t&&t.logo&&e.push({position:t.logo.position,margin:t.logo.margin,size:t.logo.size,bg_color:t.logo.backgroundColor,bg_opacity:t.logo.backgroundOpacity}),e),[])};P&&"localVideo"===P.type&&o.Z.enabled("videoTagging")&&(R.interest_tags=c.length);let O={pin_draft_id:m,has_description:!!E,has_link:!!y,has_title:!!I,is_video:"video"===A,media_upload_id:P&&"localVideo"===P.type?P.uploadId:void 0,pin_builder_data:JSON.stringify(R),pin_format:A,num_user_mention_tags:f.length,signals:JSON.stringify(S),..."image"===A||"carousel"===A||"video"===A&&o.Z.enabled("videoEditing")?{has_logo:b.some(e=>!!e&&!!e.logo),has_text:b.some(e=>!!e&&!!e.text),is_cropped:b.some(e=>{if(!e||!e.layout)return!1;let t=e.layout.sections.map(e=>e.media);return t.length>1||1===t.length&&!!t[0]&&(0!==t[0].angle||t[0].flipX||t[0].flipY||t[0].viewbox&&(1!==t[0].viewbox.width||1!==t[0].viewbox.height))}),is_trimmed:P&&"localVideo"===P.type?!!P.trimmedStartTime&&!!P.trimmedEndTime&&!!P.duration&&(P.trimmedStartTime>0||P.duration-P.trimmedEndTime>.01):void 0}:Object.freeze({}),pin_builder_scenario:o.Z.scenario(),...p?{url_creation_source:p}:Object.freeze({})};if((0,l.Z)(u,{event_type:1,object_id_str:a,aux_data:{...O}}),P&&"localVideo"===P.type){if(P.customCoverImg)(0,l.Z)(u,{event_type:7896,object_id_str:a});else{let e=(100*P.thumbnail/P.duration).toFixed(2);(0,l.Z)(u,{event_type:7517,object_id_str:a,aux_data:{percentage_scrubbed:e}})}}}));let{pinItemIds:n,pinItemIndex:_,selectedItem:d}=s[m],p=n[_],I=T.board&&T.board.id||d&&d.boardId;return e((0,f.f5)(p,T.id,r&&r.advertiser_id,t,u,c)).then(()=>{e(X(m,T.id)),e((0,h.Br)({boardId:I,sectionId:T.section?T.section.id:null,increment:1})),e((0,g.vX)({feedId:T.section?T.section.id:I,feedType:T.section?N.Z.BOARD_SECTION_PINS:N.Z.BOARDFEED,itemIds:[T.id],itemType:"pin"})),e((0,O.JS)({userId:P,increment:1}))})}),e(U(m,"succeeded")),e(L(m,"succeeded")),e((0,I.F)(T.id))}catch(t){e((e,a)=>{let s=a();if(t&&(t.message||t.message_detail)){let a=t.message_detail||t.message,{pinItemIds:o,pinItemIndex:n}=s.pinbuilder.pinDrafts[m],l=o[n],_=[];switch(t.api_error_code){case 9:switch((t.data||{}).source_field){case"description":_.push({...D("DESCRIPTION_INVALID",i,l,r),message:a});break;case"title":_.push({...D("TITLE_INVALID",i,l,r),message:a});break;default:_.push({...D("URL_INVALID",i,l,r),message:a})}break;case 2378:_.push({...D("CAROUSEL_DIFFERENT_RATIOS",i,m,r),dispatchId:m,message:a});break;default:e(k(m,a,t.api_error_code))}_.length>0&&e((0,A.d)(_,u))}}),e(U(m,"attempted")),e(L(m,"serverError"))}}}({checkExperiment:E,country:r,i18n:u,ideaPinRenamingEnabled:c,isPartner:d,logContextEvent:m,orbacSubjectId:i,pinDraftId:e,siteType:P,userId:t}))}}function eU({pinDraftId:e,i18n:t,logContextEvent:i,siteType:r,ideaPinRenamingEnabled:a}){return(s,o)=>{let{pinbuilder:n}=o(),{pinDrafts:l,pinItems:_,storyPinItems:d}=n,{pinItemIds:u,pinItemIndex:c,type:h}=l[e];if("single"===h||"story"===h){let o=u[c],{media:n}="story"===h?d[o]:_[o];if(n&&!n.signature){let{src:l}=n;(0,p.GV)(l,3===r?"ads-builder-pinimage":"pinimage").then(({signature:r})=>{s((0,f.Sz)(o,{signature:r})),s((0,A.Z)({pinDraftId:e,validationKey:"signal",i18n:t,ideaPinRenamingEnabled:a,logContextEvent:i,options:{fieldToCheck:"image_signature"}})).catch(()=>{})})}}}}function eL({pinDraftId:e,selectedId:t,cachedItems:i,editedMedia:r,canvasJson:a,userId:s,country:o,i18n:n,logContextEvent:l,siteType:_,ideaPinRenamingEnabled:d}){return(u,c)=>{let{pinItemIds:p,type:h}=c().pinbuilder.pinDrafts[e];p.forEach(e=>{let{canvasJson:s,media:o}=i[e]||{},n=t===e?r:o,l=t===e?a:s,_="story"===h?R.WZ:f.k8;l&&n&&u(_(e,n,l))});let{media:g}=i[t];"single"===h&&g&&"localVideo"===g.type?u((0,b.q)({pinDraftId:e,userId:s,country:o,i18n:n,ideaPinRenamingEnabled:d,logContextEvent:l})):u(eU({pinDraftId:e,i18n:n,logContextEvent:l,siteType:_,ideaPinRenamingEnabled:d}))}}function ew({pinDraftId:e,userId:t,country:i,isPartner:a,i18n:s,logContextEvent:o,orbacSubjectId:n,checkExperiment:l,siteType:_,ideaPinRenamingEnabled:d}){return(u,c)=>{let{pinbuilder:{pinDrafts:p}}=c(),{pinItemIds:h,pinItemIndex:g,websiteLink:m,websiteMedia:I,selectedItem:E,createMethod:y}=p[e],T="webImage"===I[0].type&&I[0].sourceURL?I[0].sourceURL:m,A=h[g];u((0,f.mO)(A,I[0])),u((0,f.PF)(A,T)),u(eC({pinDraftId:e,userId:t,orbacSubjectId:n,country:i,isPartner:a,i18n:s,logContextEvent:o,checkExperiment:l,siteType:_,ideaPinRenamingEnabled:d})),I.slice(1).forEach(e=>{let c=(0,r.Z)(),p=(0,r.Z)();u((0,P.Z)(c,p,{media:e,link:T})),u(z(c,E)),y&&u(C(c,y)),u(eC({pinDraftId:c,userId:t,orbacSubjectId:n,country:i,isPartner:a,i18n:s,logContextEvent:o,checkExperiment:l,siteType:_,ideaPinRenamingEnabled:d}))})}}function ek(e){return(t,i)=>{let{pinbuilder:{pinDrafts:r}}=i();for(let[i,a]of Object.entries(r))if(a.pinId===e){t((0,y.Z)(i));return}}}},253084:(e,t,i)=>{"use strict";i.d(t,{C_:()=>P,OD:()=>I,PF:()=>g,Sz:()=>h,b0:()=>N,f5:()=>b,hL:()=>O,jP:()=>u,k8:()=>f,kS:()=>c,kf:()=>S,lZ:()=>m,mO:()=>p,nh:()=>y,oe:()=>R,yV:()=>A});var r=i(172045),a=i(216167),s=i(968946),o=i(578278),n=i(84442),l=i(241133),_=i(440204),d=i(629471);function u(e,t,i){return{type:"PIN_ITEM_SET_DESCRIPTION_ERROR",payload:{pinItemId:e,descriptionError:t,signals:i}}}function c(e,t,i){return{type:"PIN_ITEM_SET_TITLE_ERROR",payload:{pinItemId:e,titleError:t,signals:i}}}function p(e,t){return{type:"PIN_ITEM_SET_MEDIA",payload:{pinItemId:e,media:t}}}function h(e,t){return{type:"PIN_ITEM_UPDATE_MEDIA",payload:{pinItemId:e,media:t}}}function g(e,t){return{type:"PIN_ITEM_SET_LINK",payload:{pinItemId:e,link:t}}}function m(e,t,i){return{type:"PIN_ITEM_SET_LINK_ERROR",payload:{pinItemId:e,linkError:t,signals:i}}}function I(e,t){return{type:"PIN_ITEM_SET_TAG_ERROR",payload:{pinItemId:e,tagError:t}}}function E(e,t){return(i,r)=>{let{pinbuilder:{pinTags:a}}=r(),{status:s}=a[t];i("created"===s?{type:"PIN_ITEM_REMOVE_PIN_TAG",payload:{pinItemId:e,pinTagId:t}}:(0,l.Cf)(t,"deleted"))}}function P(e,t){return{type:"PIN_ITEM_SET_SELECTED_PIN_TAG_ID",payload:{pinItemId:e,selectedPinTagId:t}}}function f(e,t,i){return{type:"PIN_ITEM_SET_EDITED_IMAGE",payload:{pinItemId:e,editedMedia:t,canvasJson:i}}}function y(e,t){return{type:"PIN_ITEM_UPDATE_DATA",payload:{pinItemId:e,pinItem:t}}}let T=(e,t)=>{t({event_type:9070,view_type:212,component:13308,element:10973,aux_data:{api_error_code:e.api_error_code,api_error_message:e.message}})};function A(e){let t=(0,d.A$)();return(i,r)=>{let a=r(),{selectedPinTagId:s}=a.pinbuilder.pinItems[e];i(P(e,null)),s&&0===t(a,{pinTagId:s}).length&&i(E(e,s))}}function b(e,t,i,r,n,l){return(_,d)=>{let{pinbuilder:u}=d(),{pinItems:c,pinTags:p,taggedObjects:h}=u;if(!c[e])return Promise.resolve();let{pinTagIds:g}=c[e],m=g.reduce((e,t)=>{let{taggedObjectIds:i}=p[t];return i.forEach(t=>e.push(h[t])),e},[]);return m.length>0?(0,o.Fv)(l,n).then(e=>{var _;return Promise.all((_=e.id,m.map(e=>{let{id:t,link:i,media:r,type:a}=e;return(0,s.Z)(i)&&/\/pin\/[\w-]+\/?$/.test(i)||"pin"===a?{id:t}:(0,o.iX)({link:i,board_id:_,image_url:r?r.url:"",method:"scraped",scrape_metric:{source:"www_url_scrape"},...l?{orbac_subject_id:l}:Object.freeze({})})}))).then(e=>{let s=e.map(e=>e.id),o=g.map(e=>{let{taggedObjectIds:t,x:i,y:a}=p[e];return{country:r,height:0,tagged_objects:s.splice(0,t.length),width:0,x_coord:100*i,y_coord:100*a}});a.Z.create("VisualLinkPinTagsAndObjectsResource",{pinId:t,pinTagsAndObjects:o,advertiserId:i,...l?{orbacSubjectId:l}:Object.freeze({})}).callUpdate({}).catch(e=>{T(e,n)})})}):Promise.resolve()}}function S(e,t){return{type:"PIN_ITEM_SET_IS_TAGGABLE",payload:{pinItemId:e,isTaggable:t}}}function R(e,t){return i=>{i((0,n.Z)(e,t,{id:t,x:0,y:0})),i(P(e,t))}}function O(e,t,i){return a=>{let s=(0,r.Z)();a((0,n.Z)(e,s,{id:s,x:t,y:i})),a(P(e,s))}}function N(e){let t=(0,_.vd)(),i=(0,d.A$)();return(r,a)=>{let s=a();r(I(e,null)),t(s,{pinItemId:e}).forEach(t=>{0===i(s,{pinTagId:t}).length&&r(E(e,t))})}}},241133:(e,t,i)=>{"use strict";i.d(t,{Cf:()=>n,Dn:()=>_,Go:()=>l,mz:()=>o,uM:()=>s});var r=i(305138),a=i(828277);function s(e,t,i){return{type:"PIN_TAG_SET_COORDINATES",payload:{pinTagId:e,x:t,y:i}}}function o(e,t,i){return{type:"PIN_TAG_SET_LINK",payload:{pinTagId:e,link:t,error:i}}}function n(e,t){return{type:"PIN_TAG_SET_STATUS",payload:{pinTagId:e,status:t}}}function l(e,t){return(i,r)=>{let{pinbuilder:{taggedObjects:s}}=r(),{status:o}=s[t];i("created"===o?{type:"PIN_TAG_REMOVE_TAGGED_OBJECT",payload:{pinTagId:e,taggedObjectId:t}}:(0,a.k)(t,"deleted"))}}function _(e,t,i){return(a,s)=>{a((0,r.Z)(e,t,{...i,id:t,link:s().pinbuilder.pinTags[e].link})),a(o(e,""))}}},10540:(e,t,i)=>{"use strict";function r(e){return{type:"PIN_BUILDER_REMOVE_PIN_DRAFT_ID",payload:{pinDraftId:e}}}i.d(t,{Z:()=>r})},727812:(e,t,i)=>{"use strict";function r(e,t){return{type:"PIN_BUILDER_SET_PIN_DRAFT_UPLOAD_STATUS",payload:{pinDraftId:e,status:t}}}i.d(t,{g:()=>r})},828277:(e,t,i)=>{"use strict";function r(e,t){return{type:"TAGGED_OBJECT_SET_STATUS",payload:{taggedObjectId:e,status:t}}}i.d(t,{k:()=>r})},960671:(e,t,i)=>{"use strict";i.d(t,{Z:()=>d,d:()=>_});var r=i(622350),a=i(132545),s=i(474052),o=i(253084),n=i(686387),l=i(701785);function _(e,t,i){return(a,_)=>{e.forEach(e=>{let d=e.dispatchId||"";switch((0,l.T)({name:"React PinBuilder Exception",message:Array.isArray(e.message)?e.message.join(""):e.message,message_detail:JSON.stringify({dispatchId:e.dispatchId,pinDraftId:i})}),(0,r.GB)(e.id,e.message,t),e.id){case"ALT_TEXT_OVER_MAX_CHARACTER_LIMIT":a((0,s.KN)(d,e.message));break;case"BOARD_MISSING":a((0,s.xb)(d,e.message));break;case"DATE_TOO_FAR_IN_FUTURE":case"DATE_IN_PAST":case"DATE_MISSING":a((0,s.Yr)(d,e.message));break;case"CAROUSEL_DIFFERENT_RATIOS":case"STORY_PIN_COVER_PAGE_INVALID_ASPECT_RATIO":case"STORY_PIN_COVER_PAGE_TITLE_MISSING":case"STORY_PIN_TITLE_MISSING":case"STORY_PIN_NOT_ENOUGH_PAGES":case"STORY_PIN_VIDEO_ON_COVER":a((0,s.lT)(d,e.message));break;case"CAROUSEL_INVALID_FORMAT":case"MEDIA_MISSING":a((0,s._B)(d,e.message));break;case"TIME_MISSING":a((0,s.Ve)(d,e.message));break;case"TITLE_INVALID":a((0,o.kS)(d,e.message));break;case"DESCRIPTION_INVALID":a((0,o.jP)(d,e.message));break;case"IMAGE_IS_BLURRY":case"IMAGE_IS_SCREENSHOT":case"LINK_LOADS_SLOWLY":case"LINK_IS_AGGREGATOR":case"IMAGE_UNDER_MIN_DIMENSIONS":case"VIDEO_UNDER_MIN_DIMENSIONS":case"IMAGE_DOES_NOT_HAVE_RECOMMENDED_RATIO":a((0,o.nh)(d,{signals:{[e.id]:!0}}));break;case"TAG_INVALID":case"URL_INVALID":case"URL_IS_REDIRECT":case"URL_MISSING":case"URL_UNREACHABLE":case"URL_CONTAINS_PORN_DOMAIN":case"URL_IS_TOO_LONG":case"URL_IS_BLOCKED":{let{pinbuilder:t}=_(),{pinDrafts:i,pinDraftIds:r}=t,s="URL_UNREACHABLE"===e.id||"URL_CONTAINS_PORN_DOMAIN"===e.id?{[e.id]:!0}:void 0;r&&"story"===i[r[0]].type?(a((0,n.qG)(d,e.message)),a((0,n.pq)(d,{isFetching:!1}))):a((0,o.lZ)(d,e.message,s))}}})}}let d=function({pinDraftId:e,validationKey:t,i18n:i,logContextEvent:r,options:s,ideaPinRenamingEnabled:o}){return n=>n(function({pinDraftId:e,validationKey:t,i18n:i,ideaPinRenamingEnabled:r,options:s}){return o=>{try{switch(t){case"save":return o((0,a.x)(e,i,r));case"edit":return o((0,a.J6)(e,i,r));case"publishStoryPin":return o((0,a.f5)(e,i,r));case"link":return Promise.all(o((0,a.Oc)(e,i,r))).then(e=>e.filter(Boolean).flat());case"signal":let n=s?s.fieldToCheck:null;return o((0,a.DY)(e,i,n,r)).then(e=>e.filter(Boolean));default:return Promise.resolve([])}}catch(i){return(0,l.T)({name:"React PinBuilder Validation Exception",message:i.message,message_detail:JSON.stringify({pinDraftId:e,validationKey:t,options:s}),...i.lineNumber&&{line:i.lineNumber},...i.stack&&{stack:i.stack}}),Promise.resolve([])}}}({pinDraftId:e,validationKey:t,i18n:i,ideaPinRenamingEnabled:o,options:s})).then(t=>{if(t.length>0&&(n(_(t,r,e)),t.some(e=>e.blocking)))throw Error();return Promise.resolve()})}},884308:(e,t,i)=>{"use strict";i.d(t,{d:()=>E,q:()=>P});var r=i(203966),a=i(984234),s=i(625303),o=i(18769),n=i(93220),l=i(599965),_=i(578278),d=i(486595),u=i(461738),c=i(474052),p=i(253084),h=i(727812),g=i(686387),m=i(204595),I=i(953565);function E({pinDraftId:e,pinItemId:t,userId:i,country:l,i18n:E,logContextEvent:P,orbacSubjectId:f,checkExperiment:y,ideaPinRenamingEnabled:T,isMaxVideo:A}){return(b,S)=>{let R;let{createFlow:O,pinbuilder:N}=S()||{},{forms:D}=O||{},{campaigns:v}=D||{},M=!!v&&v["0"]?.premiereSpotlightEnabled,{pinDrafts:C,pinDraftIds:U,pinItems:L,storyPinItemBlocks:w,storyPinItems:k}=N,{pinItemIds:z,status:F,type:x}=C[e],B="story"===x,{media:V}=B?k[t]:L[t],G=B?z.findIndex(e=>e===t):void 0,Z=B&&k[t]&&k[t].blockIds.length?k[t].blockIds.find(e=>"story_pin_video_block"===w[e].type):null,Y=Z?w[Z].media:V;if(!Y||"localVideo"!==Y.type)throw Error("Unable to upload video - media is invalid.");b((0,c._B)(e,null)),"succeeded"===F&&b((0,c.p3)(e,"uploading")),b((0,h.g)(e,"uploading")),b((0,u.addPinBuilderPinDraftItemUpload)(e,t,{status:"uploading",xhr:null}));let j=e=>b((0,g.Bl)(t,{uploadProgress:Math.round(100*(e.loaded/e.total))}));B&&Z&&(j=t=>b((0,m.PF)(e,Z,{uploadProgress:Math.round(100*(t.loaded/t.total))}))),R=B?"video-story-pin":"ad_creation"===a.Z.scenario()?"ads-video":"video",(M||A&&["ads-video","video"].includes(R))&&(R="premiere-ads-video");let H=(f,A=0)=>{(0,n.Z)(Y.fileSrc,R,B||!a.Z.enabled("videoEditing"),{onCancelUpload:e=>{(0,o.Z)(P,{event_type:7684,aux_data:{file_size_mb:Y.fileSrc.size/1048576,media_upload_id:e,story_pin_page_id:G,video_duration:Y.duration}})},onFailureUpload:({message:e,failureReason:t,uploadId:i})=>{(0,o.Z)(P,{event_type:8786,aux_data:{error_message:e,file_size_mb:Y.fileSrc.size/1048576,media_upload_failure_reason:t||"general",media_upload_id:i,story_pin_page_id:G,video_duration:Y.duration}}),(0,I.nP)("video_pin_creation.uploading.failure",{sampleRate:1,tags:{failure_reason:e}})},onFinishProcessing:({processingTime:e,signature:t,uploadId:i})=>{(0,o.Z)(P,{event_type:7520,aux_data:{file_size_mb:Y.fileSrc.size/1048576,media_upload_id:i,processing_time:e,story_pin_page_id:G,video_duration:Y.duration,video_signature:t}}),(0,o.Z)(P,{event_type:7521,aux_data:{file_size_mb:Y.fileSrc.size/1048576,media_upload_id:i,story_pin_page_id:G,video_duration:Y.duration,video_signature:t}})},onFinishUpload:({amzId2:e,amzRequestId:t,statusCode:i,uploadId:r,uploadTime:a})=>(function({amzId2:e,amzRequestId:t,statusCode:i,storyPageNumber:r,uploadId:a,uploadTime:s,video:n},l){(0,o.Z)(l,{event_type:7519,aux_data:{aws_tracking_ids:JSON.stringify([t,e]),file_size_mb:n.fileSrc.size/1048576,media_upload_id:a,status_code:i,story_pin_page_id:r,upload_time:s,video_duration:n.duration}}),(0,I.nP)("video_pin_creation.uploading.success",{sampleRate:1,tags:{app_type:"web"}})})({amzId2:e,amzRequestId:t,statusCode:i,storyPageNumber:G,uploadId:r,uploadTime:a,video:Y},P),onProgress:e=>B?j(e):b((0,p.Sz)(t,{uploadProgress:Math.round(100*(e.loaded/e.total))})),onStartProcessing:({signature:e,uploadId:t})=>{(0,o.Z)(P,{event_type:8809,aux_data:{file_size_mb:Y.fileSrc.size/1048576,media_upload_id:t,story_pin_page_id:G,video_duration:Y.duration,video_signature:e}})},onStartUpload:({uploadId:i})=>b((r,a)=>{let{pinbuilder:s}=a(),{storyPinItemBlocks:n,storyPinItems:l}=s;if(B){if(l[t]&&l[t].blockIds.length){let a=l[t].blockIds.find(e=>"story_pin_video_block"===n[e].type);a&&r((0,m.PF)(e,a,{uploadId:i}))}else r((0,g.Bl)(t,{uploadId:i}))}else r((0,p.Sz)(t,{uploadId:i}));(0,o.Z)(P,{event_type:7518,aux_data:{file_size_mb:Y.fileSrc.size/1048576,media_upload_id:i,story_pin_page_id:G,video_duration:Y.duration}})}),setXhr:i=>b((0,u.setPinBuilderPinItemUploadXhr)(e,t,i))}).then(r=>{let{pinbuilder:o}=S(),{pinDraftIdUploadStatusMap:n}=o;if(n[e]&&b((0,u.setPinBuilderPinItemUploadXhr)(e,t,null)),B){if(Z){if(b((0,m.PF)(e,Z,{signature:r.signature})),n[e]&&n[e].items[t]&&"queueEdit"===n[e].items[t].status){"queueCreate"===n[e].status&&b(function({country:e,i18n:t,ideaPinRenamingEnabled:i,logContextEvent:r,pinDraftId:a,pinItemId:o,userId:n}){return(l,p)=>{let{pinbuilder:{storyPinItemBlocks:h,storyPinItems:g}}=p();if(g[o]&&g[o].blockIds.length){let I=g[o].blockIds.find(e=>"story_pin_video_block"===h[e].type),E=I?h[I].media:null;if(I&&E&&"localVideo"===E.type&&E.signature&&void 0!==E.trimmedEndTime&&void 0!==E.trimmedStartTime&&!(0===E.trimmedStartTime&&E.trimmedEndTime===E.duration)){let{signature:h,trimmedEndTime:g,trimmedStartTime:P}=E;l((0,u.setPinBuilderPinItemUploadStatus)(a,o,"uploadingEdit")),l((0,m.PF)(a,I,{signature:null})),(0,_.Yv)(h,"video-story-pin",{time_start:(0,s.TA)(P),time_end:(0,s.TA)(g)},{onStartEdits:e=>l((0,m.PF)(a,I,{uploadId:e}))}).then(s=>{let{pinbuilder:_}=p(),{pinDraftIdUploadStatusMap:h}=_;l((0,m.PF)(a,I,{signature:s.signature})),h[a]&&l((0,u.setPinBuilderPinItemUploadStatus)(a,o,"completed"));let g=Object.keys(h[a].items).filter(e=>h[a].items[e].status.startsWith("uploading")||h[a].items[e].status.startsWith("queue"));(0===g.length||1===g.length&&g[0]===o)&&"queueCreate"===h[a].status&&(l((0,c.iX)({pinDraftId:a,userId:n,country:e,isPartner:!1,i18n:t,logContextEvent:r,ideaPinRenamingEnabled:i})),l((0,d.y2)(a)))}).catch(()=>{l((0,c._B)(a,t.bt("Przesyłanie zmian w pliku wideo nie powiodło się", "Video edit upload failed", "pinbuilder.upload.video.edit.error", undefined, true))),l((0,c.p3)(a,"attempted")),l((0,m.PF)(a,I,{signature:h})),l((0,u.setPinBuilderPinItemUploadStatus)(a,o,"queueEdit"))})}}}}({country:l,i18n:E,ideaPinRenamingEnabled:T,logContextEvent:P,pinDraftId:e,pinItemId:t,userId:i}));return}}else b((0,g.Bl)(t,{signature:r.signature}))}else b((0,p.Sz)(t,{signature:r.signature}));n[e]&&b((0,u.setPinBuilderPinItemUploadStatus)(e,t,"completed"));let I=Object.keys(n[e].items).filter(t=>n[e].items[t].status.startsWith("uploading")||n[e].items[t].status.startsWith("queue"));"queueCreate"===n[e].status&&(0===I.length||1===I.length&&I[0]===t)&&(b((0,c.iX)({pinDraftId:e,userId:i,orbacSubjectId:f,country:l,isPartner:!1,i18n:E,logContextEvent:P,checkExperiment:y,ideaPinRenamingEnabled:T})),b((0,h.g)(e,"completed"))),(0===I.length||1===I.length&&n[e].items[t])&&(a.Z.enabled("multi_pin")||a.Z.enabled("multi_pin_pinner")||a.Z.enabled("offsite_pin_creation_multi_select")||B||"queueCreate"!==n[e].status)&&b((0,d.y2)(e))}).catch(i=>{let{pinbuilder:a}=S(),{pinDraftIdUploadStatusMap:s}=a;if(!i||i.isError){if(B&&A<r.g1)H(f,A+1);else{let i=U.length>1?E.bt("Przesyłanie nie powiodło się", "Upload failed", "pinbuilder.upload.video.upload.error", undefined, true):E.bt("Przesyłanie nie powiodło się. Czy spróbować ponownie?", "Upload failed. Try again?", "pinbuilder.upload.video.upload.error", undefined, true);b((0,c._B)(e,i)),b((0,c.p3)(e,"attempted")),b((0,d.su)(e,t)),1===Object.keys(s[e].items).length&&b((0,d.y2)(e))}}})};H(f)}}function P({pinDraftId:e,userId:t,country:i,i18n:r,logContextEvent:a,ideaPinRenamingEnabled:s}){return(o,n)=>{let{pinbuilder:u}=n(),{pinDrafts:h,pinItems:g,pinDraftIds:m}=u,{pinItemIds:I,pinItemIndex:E,type:P}=h[e];if("single"===P){let u=I[E],{media:h,canvasJson:P}=g[u],f=h&&h.signature?h.signature:null;if(h&&f){let g=P?(0,l.Z)(h,P):null;g&&(0,_.Yv)(f,"video",g,{onStartEdits:e=>o((0,p.Sz)(u,{uploadId:e}))}).then(()=>{let{pinbuilder:l}=n(),{pinDraftIdUploadStatusMap:_}=l;"queueCreate"===_[e].status&&o((0,c.iX)({pinDraftId:e,userId:t,country:i,isPartner:!1,i18n:r,logContextEvent:a,ideaPinRenamingEnabled:s})),o((0,d.y2)(e))}).catch(()=>{let t=m.length>1?r.bt("Przesyłanie nie powiodło się", "Upload failed", "pinbuilder.upload.video.edit.error", undefined, true):r.bt("Przesyłanie nie powiodło się. Czy spróbować ponownie?", "Upload failed. Try again?", "pinbuilder.upload.video.edit.error", undefined, true);o((0,c._B)(e,t)),o((0,c.p3)(e,"attempted")),o((0,d.y2)(e))})}}}}},744807:(e,t,i)=>{"use strict";i.d(t,{Jc:()=>l,TX:()=>o,Tn:()=>s,hg:()=>n});var r=i(216167),a=i(386129);function s(e){return{type:"SCHEDULED_PIN_CREATE_COMPLETE",payload:{scheduledPin:e}}}function o(e,t,i){return s=>(s({type:"SCHEDULED_PIN_DELETE_COMPLETE",payload:{scheduledPinId:e}}),s((0,a.h6)({userId:t,increment:-1})),r.Z.create("ScheduledPinResource",{scheduled_pin_id:e,...i?{orbac_subject_id:i}:{}}).callDelete())}function n(e,t,i){return s=>(s({type:"SCHEDULED_PIN_PUBLISH_COMPLETE",payload:{scheduledPinId:e}}),s((0,a.h6)({userId:t,increment:-1})),r.Z.create("ScheduledPinResource",{method:"publish",scheduled_pin_id:e,...i?{orbac_subject_id:i}:{}}).callCreate())}function l(e){return t=>{let{boardId:i,description:a,link:s,sectionId:o,scheduledPinId:n,scheduledTimestamp:l,userMentionTags:_,title:d}=e,u=r.Z.create("ScheduledPinResource",{board:i,description:a,link:s,section:o,scheduled_pin_id:n,scheduled_timestamp:l,user_mention_tags:_,title:d}).callUpdate();return t({type:"SCHEDULED_PIN_UPDATE_COMPLETE",payload:e}),u}}},391404:(e,t,i)=>{"use strict";function r(e,t,i,r){return{type:"PIN_DRAFT_ADD_STORY_PIN_ITEM",payload:{pinDraftId:e,pinItemId:t,pinItem:i,options:r}}}i.d(t,{Z:()=>r})},844028:(e,t,i)=>{"use strict";function r(e){return function(t,i){t&&console.log(`${e} - ${i}`)}}i.d(t,{Z:()=>r})},276909:(e,t,i)=>{"use strict";i.d(t,{Z:()=>T});var r=i(961936),a=i(172045),s=i(372085),o=i(339001),n=i(844028),l=i(578278);let _=[200,201,204];async function d(e,t,i,r,a,s,n){let l=a.upload_id||"",d=a.upload_url||"",u=a.upload_parameters||{};s?.addSubspan({name:`${t}_page_publish-${l}`,startTime:performance.now(),bypassIsTimingCheck:!0});let{onFailure:c,onFinishUpload:p,onStartUpload:h,onUploadProgress:g}=r;h&&h(l);let m=new Date,I=new XMLHttpRequest;"image"===t?I.open("POST",d.replace("pinterest-media-upload.s3.amazonaws","u.pinimg"),!0):I.open("POST",d,!0),I.onload=()=>{if(_.includes(I.status)){if(p){let e=(Date.now()-m.getTime())/1e3,t=I.getResponseHeader("x-amz-request-id");p(l,{amzId2:I.getResponseHeader("x-amz-id-2"),amzRequestId:t,uploadTimeSec:e,statusCode:I.status})}}else c({uploadId:l,errorMsg:(0,o.nk)(n.bt("Nie udało się przesłać elementu typu {{ mediaType }} z następującym kodem statusu XHR: {{ xhrStatus }}", "Failed to upload the {{ mediaType }} with XHR status code: {{ xhrStatus }}", "uploadMedia.xhrOnLoad.failure", undefined, true),{mediaType:t,xhrStatus:I.status}).join(),mediaUploadFailureReason:"image"===t?1:8,retry:!0})},I.onerror=()=>{c({uploadId:l,errorMsg:(0,o.nk)(n.bt("Nie udało się przesłać elementu typu {{ mediaType }}", "Failed to upload the {{ mediaType }}", "uploadMedia.xhrOnError.failure", undefined, true),{mediaType:t}).join(),mediaUploadFailureReason:"image"===t?1:8,retry:!0})},g&&(I.upload.onprogress=e=>{g(Math.round(100*(e.loaded/e.total)))});let E=new FormData;return Object.keys(u).forEach(e=>{e&&u[e]&&E.append(e,u[e])}),E.append("file",e),I.send(E),{uploadId:l,xhr:I}}function u(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let c=["webImage","webVideo"];class p{constructor(e){u(this,"upload",()=>{}),u(this,"onFailure",({errorMsg:e,mediaUploadFailureReason:t,retry:i,uploadId:r})=>{i&&this.numAttempts<this.maxUploadAttempts?this.upload():(this.status="failed",this.callbackHandlers.onFailure({errorMsg:e,mediaUploadFailureReason:t,uploadId:r,storyPinPublishStopwatch:this.storyPinPublishStopwatch}))}),u(this,"onFinishProcessing",(e,t)=>{this.signature=t.signature,this.callbackHandlers.onFinishProcessing&&this.callbackHandlers.onFinishProcessing(e,t,this.storyPinPublishStopwatch)}),u(this,"onFinishUpload",(e,t)=>{this.status="uploaded",this.callbackHandlers.onFinishUpload&&this.callbackHandlers.onFinishUpload(e,t,this.storyPinPublishStopwatch)}),u(this,"onStartProcessing",(e,t)=>{this.signature=t.signature,this.callbackHandlers.onStartProcessing&&this.callbackHandlers.onStartProcessing(e,t,this.storyPinPublishStopwatch)}),u(this,"cancel",()=>{this.xhr&&(this.xhr.abort(),this.callbackHandlers.onCancel&&this.callbackHandlers.onCancel(this.uploadId||"",this.storyPinPublishStopwatch))}),this.i18n=e.i18n,this.maxUploadAttempts=e.maxUploadAttempts||1,this.media=e.media,this.numAttempts=0,this.storyPinPublishStopwatch=e.storyPinPublishStopwatch,this.vipRegistration=e.vipRegistration,this.vipType=e.vipType,this.callbackHandlers=e.callbackHandlers}}class h extends p{constructor(e){super(e),u(this,"getClassName",()=>"ImageUpload"),u(this,"onProcessingFailed",e=>{if(this.uploadId){let t=(0,o.nk)(this.i18n.bt("Failed to process image with uploadId {{ uploadId }} and failureCode {{ failureCode }}", "Failed to process image with uploadId {{ uploadId }} and failureCode {{ failureCode }}", "MediaUpload.ImageUpload.onProcessingFailed", undefined, false),{failureCode:e,uploadId:this.uploadId}).join("");this.onFailure({uploadId:this.uploadId,errorMsg:t,mediaUploadFailureReason:3,mediaStatusFailureReason:e})}}),u(this,"onProcessingTimeout",()=>{if(this.uploadId){let e=(0,o.nk)(this.i18n.bt("Timed out on processing image with uploadId {{ uploadId }}", "Timed out on processing image with uploadId {{ uploadId }}", "MediaUpload.ImageUpload.onProcessingTimeout", undefined, false),{uploadId:this.uploadId}).join("");this.onFailure({uploadId:this.uploadId,errorMsg:e,mediaUploadFailureReason:4})}}),u(this,"upload",()=>{"localImage"===this.media.type&&(this.numAttempts+=1,d(this.media.fileSrc?this.media.fileSrc:(0,l.Mi)(this.media.src),"image",this.vipType,{onFailure:e=>this.onFailure(e),onFinishUpload:this.onFinishUpload,onStartUpload:this.callbackHandlers.onStartUpload,onUploadProgress:this.callbackHandlers.onUploadProgress},this.vipRegistration,this.storyPinPublishStopwatch,this.i18n).then(e=>{this.uploadId=e.uploadId,this.xhr=e.xhr,this.status="uploading"}))}),this.signature=c.includes(e.media.type)?e.media.signature:null,this.status=c.includes(e.media.type)?"uploaded":"pending"}}class g extends p{constructor(e){super(e),u(this,"getClassName",()=>"VideoUpload"),u(this,"onProcessingFailed",e=>{if(this.uploadId){let t=(0,o.nk)(this.i18n.bt("Failed to process video with uploadId {{ uploadId }} and failureCode {{ failureCode }}", "Failed to process video with uploadId {{ uploadId }} and failureCode {{ failureCode }}", "MediaUpload.VideoUpload.onProcessingFailed", undefined, false),{uploadId:this.uploadId,failureCode:e}).join("");this.onFailure({uploadId:this.uploadId,errorMsg:t,mediaUploadFailureReason:10,mediaStatusFailureReason:e,storyPinPublishStopwatch:this.storyPinPublishStopwatch})}}),u(this,"onProcessingTimeout",()=>{if(this.uploadId){let e=(0,o.nk)(this.i18n.bt("Timed out on processing video with uploadId {{ uploadId }}", "Timed out on processing video with uploadId {{ uploadId }}", "MediaUpload.VideoUpload.onProcessingTimeout", undefined, false),{uploadId:this.uploadId}).join("");this.onFailure({uploadId:this.uploadId,errorMsg:e,mediaUploadFailureReason:11,storyPinPublishStopwatch:this.storyPinPublishStopwatch})}}),u(this,"upload",()=>{"localVideo"===this.media.type&&(this.numAttempts+=1,d(this.media.fileSrc,"video",this.vipType,{onFailure:e=>this.onFailure(e),onFinishUpload:this.onFinishUpload,onStartUpload:this.callbackHandlers.onStartUpload,onUploadProgress:this.callbackHandlers.onUploadProgress},this.vipRegistration,this.storyPinPublishStopwatch,this.i18n).then(e=>{this.uploadId=e.uploadId,this.xhr=e.xhr,this.status="uploading"}))}),this.signature=c.includes(e.media.type)?e.media.signature:null,this.status=c.includes(e.media.type)?"uploaded":"pending"}}var m=i(216167),I=i(953565);async function E(e,t){let{data:i}=(await m.Z.create("VIPResource",{upload_ids:e}).callGet()).resource_response;return e.reduce((e,r)=>(i[r]?e[r]={failureCode:i[r].failure_code,signature:i[r].signature,status:i[r].status}:(0,I.nP)("storypin.publish.vip_status_check.missing_upload_id",{sampleRate:1,tags:{retryCount:t}}),e),{})}function P(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let f=(0,n.Z)("[MEDIA UPLOAD MANAGER]");class y{constructor(e){P(this,"getMediaRegistrationsFromVIP",async({durationMs:e,mediaType:t})=>{let i="image"===t?2:1;this.vipRegistrationPool[t].fetchingData=!0,this.debugLog(`Getting media registration urls for ${t}s`);let r=[];for(let s=0;s<i;s+=1)r.push({id:(0,a.Z)(),media_type:"image"===t?"image-story-pin":"video-story-pin",...e?{upload_aux_data:{clips:[{durationMs:e,isFromImage:"image"===t,startTimestampMs:-1}]}}:{}});let{requestCount:n}=this.vipRegistrationPool[t];return this.vipRegistrationPool[t].requestCount+=1,this.storyPinPublishStopwatch?.subspanStart({name:`${t}_registration_${n}`,bypassIsTimingCheck:!0}),(0,s.Z)({url:"/v3/media/uploads/register/batch/",method:"POST",data:{media_info_list:JSON.stringify(r)},callOptions:{showError:3===this.vipRegistrationPool[t].retries}}).then(e=>{let i="object"==typeof e.resource_response.data?Object.values(e.resource_response.data):[];this.vipRegistrationPool[t].data=i,this.vipRegistrationPool[t].retries=0,this.vipRegistrationPool[t].fetchedLast=performance.now(),this.vipRegistrationPool[t].fetchingData=!1,this.storyPinPublishStopwatch?.subspanStop({name:`${t}_registration_${n}`,bypassIsTimingCheck:!0})},i=>{(0,I.nP)(`storypin.publish.registration.${t}.failure`,{sampleRate:1,tags:{reason:i.message,retryCount:this.vipRegistrationPool[t].retries}}),this.vipRegistrationPool[t].retries<3?(this.debugLog(`${t} registration failed. ${3-this.vipRegistrationPool[t].retries} retries remaining. ${i}`),this.vipRegistrationPool[t].retries+=1,this.getMediaRegistrationsFromVIP({durationMs:e,mediaType:t})):(this.debugLog(`${t} registration failed. ${i}`),this.onFailure((0,o.nk)(this.i18n.bt("Failed to register {{ mediaType }} upload with message: {{ error }}", "Failed to register {{ mediaType }} upload with message: {{ error }}", "MediaUploadManager.getMediaRegistrationsFromVIP.failure", undefined, false),{error:i,mediaType:t}).join(""),"image"===t?13:7)),this.storyPinPublishStopwatch?.subspanStop({name:`${t}_registration_${n}`,bypassIsTimingCheck:!0})})}),P(this,"initVIPRegistrationPools",()=>{this.getMediaRegistrationsFromVIP({mediaType:"image"}),this.getMediaRegistrationsFromVIP({mediaType:"video"})}),P(this,"checkAllUploadsProcessingOrCompleted",()=>{let e=0;for(let t of Object.keys(this.mediaUploadsMap)){let i=this.mediaUploadsMap[t];this.debugLog(`Status of media upload ID ${t} ${i.mediaUpload.getClassName()} ${i.status}`),("completed"===i.status||"processing"===i.status&&"VideoUpload"===i.mediaUpload.getClassName())&&(e+=1)}return this.debugLog("Checking if all upload processes completed"),this.debugLog(`Completed ${e} out of ${Object.keys(this.mediaUploadsMap).length}`),e===Object.keys(this.mediaUploadsMap).length}),P(this,"checkUploadsFailed",()=>!!Object.keys(this.mediaUploadsMap).find(e=>"failed"===this.mediaUploadsMap[e].status&&this.mediaUploadsMap[e].processingRetryCount>2)),P(this,"updateUploadStatus",(e,t)=>this.mediaUploadsMap[e].status=t),P(this,"updateVIPStatusMap",e=>{let t=new Date,i=({mediaId:e,mediaUpload:i,signature:r,uploadId:a})=>{let s=(t.getTime()-this.vipStatusMap[a].timeSet.getTime())/1e3;i.onFinishProcessing(a,{processingTimeSec:s,signature:r}),this.updateUploadStatus(e,"completed")};for(let r of Object.keys(e)){let{failureCode:a,signature:s,status:o}=e[r];if(r in this.vipStatusMap){let{mediaId:e}=this.vipStatusMap[r],n=this.mediaUploadsMap[e];if(a&&this.mediaUploadsMap[e].processingRetryCount>2){n.mediaUpload.onProcessingFailed(a),this.updateUploadStatus(e,"failed");break}this.vipStatusMap[r].status!==o||"failed"===o?(this.vipStatusMap[r]={...this.vipStatusMap[r],status:o,timeSet:t},"processing"===o?(n.mediaUpload.onStartProcessing(r,{signature:s}),this.debugLog("Skipping media completion"),i({mediaId:e,mediaUpload:n.mediaUpload,signature:s,uploadId:r})):"succeeded"===o?(this.debugLog("Waited for media completion"),i({mediaId:e,mediaUpload:n.mediaUpload,signature:s,uploadId:r})):"failed"===o&&(this.mediaUploadsMap[e].processingRetryCount+=1,this.debugLog(`Media upload ${r} failed, but will keep checking ${3-this.mediaUploadsMap[e].processingRetryCount} times if a retry succeeds.`))):this.statusTimeoutMap[o]&&(t.getTime()-this.vipStatusMap[r].timeSet.getTime())/1e3>=this.statusTimeoutMap[o].timeoutSec&&(n.mediaUpload.onProcessingTimeout(),this.statusTimeoutMap[o].onTimeout(r,e,this.mediaUploadsMap[e].mediaUpload.getClassName()))}}}),P(this,"refreshImageRegistration",async()=>{this.vipRegistrationPool.image={fetchedLast:0,retries:0,data:[],requestCount:0,fetchingData:!1},await this.getMediaRegistrationsFromVIP({mediaType:"image"})}),P(this,"getMediaRegistration",async({durationMs:e,mediaType:t})=>{if(!e&&this.vipRegistrationPool[t]){this.vipRegistrationPool[t].fetchingData&&await new Promise(e=>{let i=0,r=setInterval(()=>{i+=1,this.vipRegistrationPool[t].fetchingData&&100!==i||(clearInterval(r),e(void 0))},100)});let i=performance.now()-this.vipRegistrationPool[t].fetchedLast>=18e5;(0===this.vipRegistrationPool[t].data.length||i)&&await this.getMediaRegistrationsFromVIP({mediaType:t,durationMs:e})}else await this.getMediaRegistrationsFromVIP({mediaType:t,durationMs:e});return Promise.resolve(this.vipRegistrationPool[t].data.pop())}),P(this,"hasAnyVideoUploads",()=>{for(let e of Object.keys(this.mediaUploadsMap))if("VideoUpload"===this.mediaUploadsMap[e].mediaUpload.getClassName())return!0;return!1}),P(this,"getVipMapStatusesToString",()=>{let e="{";for(let t of Object.keys(this.vipStatusMap))e+=`[${t}]:${this.vipStatusMap[t].status??"null"} `;return e+"}"}),P(this,"handleFailure",(e,t)=>{this.failed||(this.onFailure(e,t),this.failed=!0)}),P(this,"handleCheckUploadsCompleted",()=>{let e=this.checkAllUploadsProcessingOrCompleted();return e&&!this.completed&&(this.debugLog("All submitted media processed, calling onCompleted if it exists"),this.completed=!0,this.onCompleted()),e}),P(this,"onFinishUpload",(e,t)=>{this.vipStatusMap[e]={mediaId:t,status:null,timeSet:new Date},this.updateUploadStatus(t,"uploaded"),this.debugLog(`Finished uploading media ID ${t}`),this.statusCheckInProgress||(this.statusCheckInProgress=!0,this.waitThenCheckStatus())}),P(this,"onUploadFailed",(e,t,i)=>{this.updateUploadStatus(e,"failed"),this.handleFailure(t,i),this.debugLog(`Failed uploading media ID ${e}`)}),P(this,"removeMediaUpload",e=>{this.mediaUploadsMap[e]&&(this.mediaUploadsMap[e].mediaUpload.cancel(),delete this.mediaUploadsMap[e])}),P(this,"addMediaUpload",({media:e,mediaId:t,uploadHandlers:i})=>{let r="localImage"===e.type||"webImage"===e.type?"image":"video",a=Math.round(1e3*(e.duration||0));this.getMediaRegistration({mediaType:r,durationMs:a}).then(r=>{let a={...i,onFailure:({uploadId:e,errorMsg:r,mediaUploadFailureReason:a})=>{this.onUploadFailed(t,r,a),i.onFailure({uploadId:e,errorMsg:r,mediaUploadFailureReason:a})},onFinishUpload:(e,r)=>{this.onFinishUpload(e,t),i.onFinishUpload&&i.onFinishUpload(e,r)}},s="localImage"===e.type||"webImage"===e.type?new h({callbackHandlers:a,i18n:this.i18n,maxUploadAttempts:this.maxMediaUploadAttempts,media:e,storyPinPublishStopwatch:this.storyPinPublishStopwatch,vipRegistration:r,vipType:"image-story-pin"}):new g({callbackHandlers:a,i18n:this.i18n,maxUploadAttempts:this.maxMediaUploadAttempts,media:e,storyPinPublishStopwatch:this.storyPinPublishStopwatch,vipRegistration:r,vipType:"video-story-pin"});if(this.mediaUploadsMap[t]){this.debugLog(`Cancelling existing upload media ID ${t}`),this.mediaUploadsMap[t].mediaUpload.cancel();let{uploadId:e}=this.mediaUploadsMap[t].mediaUpload;e&&e in this.vipStatusMap&&delete this.vipStatusMap[e]}this.debugLog(`Added media ID to upload ${t}`),this.mediaUploadsMap[t]={mediaUpload:s,status:"pending",processingRetryCount:0},s.upload(),this.updateUploadStatus(t,"uploading")})}),P(this,"reset",()=>{this.failed=!1,this.statusCheckFailureCount=0,this.completed=!1}),P(this,"cancelAll",()=>{for(let e of Object.keys(this.mediaUploadsMap))"uploading"===this.mediaUploadsMap[e].status&&this.mediaUploadsMap[e].mediaUpload.cancel()}),P(this,"checkStatus",async()=>{if(this.checkUploadsFailed()){this.statusCheckInProgress=!1,this.debugLog(`There is a failure in check status ${this.getVipMapStatusesToString()}`);return}this.debugLog(`Checking status ${this.getVipMapStatusesToString()}`),this.statusCheckInProgress=!0;let e=Object.keys(this.vipStatusMap);if(e.length>0)try{let t=await E(e,this.statusCheckFailureCount);this.updateVIPStatusMap(t),this.debugLog(`Check status response received ${this.getVipMapStatusesToString()}`);let i=this.handleCheckUploadsCompleted();for(let e of Object.keys(this.vipStatusMap)){let{mediaId:t}=this.vipStatusMap[e];if(this.mediaUploadsMap[t]){if("completed"===this.mediaUploadsMap[t].status){let i=this.mediaUploadsMap[t].mediaUpload.signature;this.mediaUploadsMap[t].mediaUpload.vipType.includes("video")&&i&&(this.storyPinPublishStopwatch?.updateSubspanName({currentName:`video_page_upload-${e}`,newName:`video_page_upload-${i}`,bypassIsTimingCheck:!0}),this.storyPinPublishStopwatch?.updateSubspanName({currentName:`video_page_publish-${e}`,newName:`video_page_publish-${i}`,bypassIsTimingCheck:!0})),delete this.vipStatusMap[e]}}else(0,I.nP)("storypin.publish.media_uploads_map.missing_upload_id",{sampleRate:1,tags:{retryCount:this.statusCheckFailureCount,mediaId:t,vipId:e,mediaType:this.mediaUploadsMap[t].mediaUpload.getClassName()}})}i?this.statusCheckInProgress=!1:this.waitThenCheckStatus()}catch(e){this.statusCheckFailureCount+=1,this.statusCheckFailureCount>4?(this.debugLog(`Failing upload because status check failed ${this.statusCheckFailureCount} times`),this.handleFailure((0,o.nk)(this.i18n.bt("Could not check VIP status with error: {{ errorName }} {{ errorMessage }}", "Could not check VIP status with error: {{ errorName }} {{ errorMessage }}", "MediaUploadManager.checkStatus.error", undefined, false),{errorName:e?.name,errorMessage:e?.message}).join(""),14),this.statusCheckInProgress=!1):(this.debugLog(`Continuing upload because status check only failed ${this.statusCheckFailureCount} times`),this.waitThenCheckStatus())}else this.handleCheckUploadsCompleted()||this.waitThenCheckStatus()}),P(this,"waitThenCheckStatus",()=>{setTimeout(this.checkStatus,this.hasAnyVideoUploads()?3e3:1e3)}),this.onCancel=e.onCancel,this.onCompleted=e.onCompleted,this.onFailure=e.onFailure,this.statusTimeoutMap=e.statusTimeoutMap,this.maxMediaUploadAttempts=e.maxMediaUploadAttempts,this.inDebugMode=e.inDebugMode,this.storyPinPublishStopwatch=e.storyPinPublishStopwatch,this.i18n=e.i18n,this.statusCheckInProgress=!1,this.completed=!1,this.failed=!1,this.vipRegistrationPool={image:{fetchedLast:0,retries:0,data:[],requestCount:0,fetchingData:!1},video:{fetchedLast:0,retries:0,data:[],requestCount:0,fetchingData:!1}},this.statusCheckFailureCount=0,this.mediaUploadsMap={},this.vipStatusMap={}}debugLog(e){f(this.inDebugMode,e)}}function T({i18n:e,isEmployee:t,pinDraftId:i,storyPinPublishStopwatch:a}){return s=>{let o=new y({i18n:e,inDebugMode:t,maxMediaUploadAttempts:r.dD,onCancel:()=>{},onCompleted:()=>{},onFailure:()=>{},statusTimeoutMap:{registered:{onTimeout:(e,t,i)=>{(0,I.nP)("storypin.publish.media_uploads_map.timeout.registered",{sampleRate:1,tags:{retryCount:this.statusCheckFailureCount,mediaId:t,uploadId:e,mediaType:i}})},timeoutSec:240},processing:{onTimeout:(e,t,i)=>{(0,I.nP)("storypin.publish.media_uploads_map.timeout.processing",{sampleRate:1,tags:{retryCount:this.statusCheckFailureCount,mediaId:t,uploadId:e,mediaType:i}})},timeoutSec:180}},storyPinPublishStopwatch:a});o.initVIPRegistrationPools(),s({type:"PIN_DRAFT_SET_STORY_PIN_UPLOAD_MANAGER",payload:{pinDraftId:i,uploadManager:o}})}}},686387:(e,t,i)=>{"use strict";i.d(t,{Bl:()=>p,Dt:()=>d,EH:()=>R,Gm:()=>b,JQ:()=>A,WZ:()=>m,d5:()=>y,dP:()=>E,eU:()=>P,go:()=>S,h4:()=>u,hC:()=>c,iY:()=>T,j8:()=>_,kh:()=>l,pq:()=>h,qG:()=>g,vi:()=>f});var r=i(172045),a=i(204595),s=i(117043),o=i(151582),n=i(961936);function l(e,t){return{type:"STORY_PIN_ITEM_SET_DESCRIPTION",payload:{pinItemId:e,description:t}}}function _(e,t){return{type:"STORY_PIN_ITEM_SET_DESCRIPTION_ERROR",payload:{pinItemId:e,descriptionError:t}}}function d(e,t){return{type:"STORY_PIN_ITEM_SET_TITLE",payload:{pinItemId:e,title:t}}}function u(e,t){return{type:"STORY_PIN_ITEM_SET_TITLE_ERROR",payload:{pinItemId:e,titleError:t}}}function c(e,t){return{type:"STORY_PIN_ITEM_SET_MEDIA",payload:{pinItemId:e,media:t}}}function p(e,t){return{type:"STORY_PIN_ITEM_UPDATE_MEDIA",payload:{pinItemId:e,media:t}}}function h(e,t){return{type:"STORY_PIN_ITEM_UPDATE_LINK_BLOCK",payload:{pinItemId:e,linkBlock:t}}}function g(e,t){return{type:"STORY_PIN_ITEM_SET_LINK_ERROR",payload:{pinItemId:e,linkError:t}}}function m(e,t,i){return{type:"STORY_PIN_ITEM_SET_EDITED_IMAGE",payload:{pinItemId:e,editedMedia:t,canvasJson:i}}}function I(e,t,i){return{type:"STORY_PIN_ITEM_UPDATE_DATA",payload:{pinDraftId:e,pinItemId:t,pinItem:i}}}function E(e,t){return{type:"STORY_PIN_ITEM_SET_BLOCK_IDS",payload:{pinItemId:e,blockIds:t}}}function P(e,t){return{type:"STORY_PIN_ITEM_SET_SELECTED_BLOCK_ID",payload:{pinItemId:e,blockId:t}}}function f(e,t,i){return{type:"STORY_PIN_ITEM_SET_BACKGROUND_COLOR",payload:{pinDraftId:e,pinItemId:t,backgroundColor:i}}}function y(e,t,i){return{type:"STORY_PIN_ITEM_SET_LAYOUT",payload:{pinDraftId:e,pinItemId:t,layout:i}}}function T(e,t){return{type:"STORY_PIN_ITEM_SET_DOMINANT_COLORS",payload:{pinItemId:e,dominantColors:t}}}function A({canvasAspectRatio:e,pinDraftId:t,pinItem:i,pinItemId:l}){return _=>{if(i.media){let{media:d}=i;"localImage"===d.type?_((0,a.Uo)(t,l,(0,r.Z)(),{media:d,edits:(0,s.Z)({canvasAspectRatio:e,media:d}),type:"story_pin_image_block"},0)):"localVideo"===d.type&&_((0,a.Uo)(t,l,(0,r.Z)(),{media:d,edits:(0,s.Z)({canvasAspectRatio:e,media:d}),type:"story_pin_video_block"},0)),("localImage"===d.type?(0,o.MW)(d):Promise.resolve([])).then(e=>_(I(t,l,{...i,backgroundColor:e.length>0?e[0]:n.Lh,dominantColors:e,media:null})))}else _(I(t,l,i))}}function b(e,t){return{type:"STORY_PIN_ITEM_SET_SELECTED_PIN_TAG_ID",payload:{pinItemId:e,selectedPinTagId:t}}}function S(e,t){return{type:"STORY_PIN_ITEM_UPDATE_CWT_DATA",payload:{pinItemId:e,cwtData:t}}}function R(e,t){return i=>{i({type:"STORY_PIN_ITEM_ADD_PIN_TAG",payload:{pinItemId:e,pinTagId:t,pinTag:{id:t,x:0,y:0}}}),i(b(e,t))}}},204595:(e,t,i)=>{"use strict";function r(e,t,i,r,a){return{type:"STORY_PIN_ITEM_ADD_BLOCK",payload:{pinDraftId:e,pinItemId:t,blockId:i,storyPinItemBlock:r,index:a}}}function a(e,t,i){return{type:"STORY_PIN_ITEM_BLOCK_UPDATE_EDITS",payload:{pinDraftId:e,blockId:t,edits:i}}}function s(e,t,i){return{type:"STORY_PIN_ITEM_BLOCK_UPDATE_MEDIA",payload:{pinDraftId:e,blockId:t,media:i}}}function o(e,t){return{type:"STORY_PIN_ITEM_BLOCK_SET_PLAYING",payload:{blockId:e,playing:t}}}function n(e,t,i){return{type:"STORY_PIN_ITEM_REMOVE_BLOCK",payload:{pinDraftId:e,pinItemId:t,blockId:i}}}function l(e,t,i){return{type:"STORY_PIN_ITEM_REORDER_BLOCKS",payload:{pinDraftId:e,pinItemId:t,blockIds:i}}}function _(e,t,i){return{type:"STORY_PIN_ITEM_UPDATE_BLOCK",payload:{pinDraftId:e,blockId:t,storyPinItemBlock:i}}}i.d(t,{Ny:()=>n,PF:()=>s,Uo:()=>r,_E:()=>a,_Z:()=>_,gs:()=>o,mI:()=>l})},386129:(e,t,i)=>{"use strict";i.d(t,{Ge:()=>_,JS:()=>o,OF:()=>f,P_:()=>n,Q_:()=>c,b8:()=>p,eR:()=>P,h2:()=>d,h6:()=>u});var r=i(216167),a=i(372085),s=i(107905);function o(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}let n=(e,t)=>({type:"USER_FOLLOW",payload:{id:e,value:t}}),l=(e,t)=>({type:"USER_BLOCK",payload:{id:e,value:t}}),_=({id:e,orbacSubjectId:t,blockSource:i,blockContext:a,logContextEvent:s})=>async o=>{o(l(e,!0));let n=await r.Z.create("UserBlockResource",{blocked_user_id:e,orbac_subject_id:t,block_source:i,block_context:a}).callCreate().catch(()=>o(l(e,!1)));return s({event_type:54,object_id_str:e}),n},d=(e,t)=>async i=>{i(l(e,!1));let a=await r.Z.create("UserBlockResource",{blocked_user_id:e}).callDelete().catch(()=>i(l(e,!0)));return t({event_type:55,object_id_str:e}),a};function u(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}let c=(e,t)=>()=>r.Z.create("UserStateResource",{state:e,value:t}).callCreate(),p=(e,t,i)=>(r,o)=>{(0,a.Z)({url:"/v3/users/me/",method:"POST"}).then(()=>{i({event_type:48,object_id_str:o().session.userId}),e(),(0,s.Z)()},t)},h=e=>e>=200&&e<400,g=(e,t="150x150")=>e&&`https://i.pinimg.com/${t}/${e.substring(0,2)}/${e.substring(2,4)}/${e.substring(4,6)}/${e}.jpg`||"",m=async(e,t,i)=>{let a=await r.Z.create("VIPResource",{upload_ids:[e]}).callGet();if(a.resource_response.data[e]){let{status:r,signature:s}=a.resource_response.data[e];"processing"===r||"registered"===r?setTimeout(async()=>{m(e,t,i)},5e3):"succeeded"===r?t(g(s)):i()}else i()},I=(e,t,i,a,s)=>(new FormData().append("img",e),r.Z.create("VIPResource",{type:t}).callCreate().then(t=>{if(t.resource_response.data){let{upload_id:r,upload_url:o,upload_parameters:n}=t.resource_response.data,l=new XMLHttpRequest;l.open("POST",o,!0),l.onload=()=>{h(l.status)?(i(100),m(r,a,s)):s()},l.upload.onprogress=e=>{i(Math.round(100*e.loaded/e.total))};let _=new FormData;for(let e in n)_.append(e,n[e]);_.append("file",e),l.send(_)}},()=>{s()})),E=e=>new Promise((t,i)=>{I(e,"pinimage",()=>{},e=>{t(e)},e=>{i(e)})}),P=e=>new Promise((t,i)=>{"string"==typeof e?e.startsWith("data")&&E(function(e,t=512){let i=e.split(";"),r=i[0].split(":")[1],a=atob(i[1].split(",")[1]),s=[];for(let e=0;e<a.length;e+=t){let i=a.slice(e,e+t),r=Array(i.length);for(let e=0;e<i.length;e+=1)r[e]=i.charCodeAt(e);let o=new Uint8Array(r);s.push(o)}return new Blob(s,{type:r})}(e)).then(e=>t(e)):i("Invalid Image")}),f=e=>()=>(0,a.Z)({url:"/v3/register/exists/",data:{email:e}})},937310:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});let r={AGGREGATED_COMMENTS:"aggregatedComments",AGGREGATED_COMMENT_REPLIES:"aggregated-comment-replies",BOARDFEED:"boardfeed",BOARDLESS_PINS:"boardless-pins",BOARD_SECTIONS:"board-sections",BOARD_SECTION_PINS:"board-section-pins",STORY_PINS_FEED:"story-pins-feed",PROFILE_PINS_FEED:"profile-pins-feed",PROFILE_BOARDS:"profileBoards",SEARCH_PINS:"searchPins",STORY_PIN_DATA:"storyPinData",TODAY_ARTICLE_INTEREST_FEED:"todayArticleInterestFeed",TODAY_TAB:"todayTabFeed",UNIFIED_COMMENTS:"unified-comments",TRIED_IT_FEED:"trieditfeed"}},626468:(e,t,i)=>{"use strict";function r(e){let t=[],i="";for(let r of e)if(i){let e=!!r.match(/\s/),a=!!i.match(/\s/);if(e===a)i+=r;else if(!a&&i.includes("-")){let e=0;for(let r=0;r<i.length;r+=1)"-"===i[r]&&(t.push(i.substring(e,r+1)),e=r+1);t.push(i.substring(e)),i=r}else t.push(i),i=r}else i=r;return i.length&&t.push(i),t}function a({boxHeight:e,boxWidth:t,font:i,startFontSize:a,text:s}){if("undefined"==typeof document||!document.body)return{fontSize:a,lines:[]};let{body:o}=document,n=document.createElement("div");o.appendChild(n);let l=s?.split(/\r?\n/g),_=a,d={letterSpacing:i.fontOverrides?.letterSpacing!=null?`${i.fontOverrides.letterSpacing}px`:void 0,lineHeight:String(i.fontOverrides?.lineHeight||1.1),fontFamily:i.fontFamily,fontSize:`${_}px`,position:"absolute",visibility:"hidden",width:`${t}px`};Object.assign(n.style,d);let u=document.createElement("div");for(u.style.display="inline",n.appendChild(u),(l??[]).forEach((e,t)=>{let i=document.createElement("span");i.style.wordBreak="break-word",u.appendChild(i),i.appendChild(document.createTextNode(e)),t!==(s??"").length-1&&i.appendChild(document.createElement("br"))});(u.offsetHeight>e||u.offsetWidth>t)&&_>0;)_-=1,n.style.fontSize=`${_}px`;return u.remove(),n.remove(),{fontSize:_,lines:_>0?function({font:e,fontSize:t,textList:i,width:a}){if("undefined"==typeof document||!document.body||a<=0||t<=0)return[];let{body:s}=document,o=document.createElement("div");s.appendChild(o);let n={letterSpacing:e.fontOverrides?.letterSpacing!=null?`${e.fontOverrides.letterSpacing}px`:void 0,lineHeight:String(e.fontOverrides?.lineHeight||1.1),fontFamily:e.fontFamily,fontSize:`${t}px`,visibility:"hidden"};Object.assign(o.style,n);let l=document.createElement("div");l.style.display="inline",o.appendChild(l);let _=document.createTextNode("");l.appendChild(_);let d=[],u="",c=e=>{let t=e.trim();return _.textContent=t,{text:t,width:l.offsetWidth}},p=e=>{let t=!!e.match(/\s/),i=0===u.length;if(_.textContent=`${u}${e}`,l.offsetWidth>a){if(t)d.push(c(u)),u="";else if(i)for(let t of e)p(t);else d.push(c(u)),u="",p(e)}else u+=e};for(let e of i??[])0===e.length&&d.push(c(u)),r(e).forEach(e=>p(e)),u.length&&(d.push(c(u)),u="");return l.remove(),o.remove(),d}({font:i,fontSize:_,textList:l,width:t}):[]}}function s(e){let t=window.getComputedStyle(e,null),i=parseFloat(t.getPropertyValue("height").replace("px","")),r=parseFloat(t.getPropertyValue("font-size").replace("px","")),a=parseFloat(t.getPropertyValue("line-height").replace("px",""));return Number.isNaN(a)&&(a=1.2*r),Math.ceil(i/a)}i.d(t,{KV:()=>a,Yd:()=>r,xW:()=>s})},363938:(e,t,i)=>{"use strict";i.d(t,{A7:()=>m,CP:()=>s,K3:()=>n,Lr:()=>h,NF:()=>p,R4:()=>d,RJ:()=>g,RO:()=>u,S8:()=>l,SO:()=>I,VH:()=>E,Z0:()=>c,iS:()=>a,k5:()=>_,uK:()=>o});var r=i(876594);let a=320,s=10,o=100,n=250,l=100,_=100,d=3,u=2,c=1,p=r.x_d,h=6,g={upload:228,design:226,details:437,target:432},m=1200,I=1400,E=104},151582:(e,t,i)=>{"use strict";i.d(t,{Cl:()=>P,MW:()=>p,Nq:()=>g,St:()=>c,T0:()=>y,V3:()=>T,Zy:()=>m,dz:()=>h,eE:()=>f,qk:()=>E,wX:()=>A,x5:()=>I});var r=i(616550),a=i(16243),s=i.n(a),o=i(5859),n=i(598228),l=i(980162),_=i(363938),d=i(961936),u=i(626468);function c(e){return["#111111","#370052","#00205C","#01564C","#363F03","#573700","#5E031A","#97026D","#8000BD","#0045CC"][e]}function p(e,t=5){return"undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.body&&window.document.body?new Promise(i=>{let{height:r,src:a,width:o}=e,n=e=>{let t=e.toString(16);return 1===t.length?"0"+t:t},l=(e,t,i)=>"#"+n(e)+n(t)+n(i),_=document.createElement("canvas");_.width=o,_.height=r;let d=document.createElement("img");d.onload=()=>{let e=_.getContext("2d");e.drawImage(d,0,0);let a=e.getImageData(0,0,o,r).data,n=[],u=o*r;for(let e=0;e<u;e+=10){let t=4*e;n.push([a[t],a[t+1],a[t+2]])}let c=s()(n,t).palette();_.remove(),d.remove(),i(c.map(e=>l(e[0],e[1],e[2])))},d.src=a}):Promise.reject([])}function h({blockStyle:e,canvasAspectRatio:t,media:i}){let r;if(!e)return{left:0,scale:1,top:0,transform:{rotate:0,scaleX:1,scaleY:1}};let a=d.q8/t,{height:s=100,width:o=100,x_coord:n=0,y_coord:l=0}=e;return r=i.width>i.height?d.q8/i.width*(o/100):a/i.height*(s/100),{left:n?n/100*d.q8:0,scale:r,top:l?l/100*a:0,transform:{rotate:0,scaleX:1,scaleY:1}}}function g(e,t,i){let r=e.split(/\r?\n/g),a=[],s="",o=e=>{let t=e.trim(),r=i.measureText(t);return{text:t,width:r.width}},n=e=>{let r=!!e.match(/\s/),l=0===s.length;if(i.measureText(`${s}${e}`).width>t){if(r)a.push(o(s)),s="";else if(l)for(let t of e)n(t);else a.push(o(s)),s="",n(e)}else s+=e};for(let e of r)0===e.length&&a.push(o(s)),(0,u.Yd)(e).forEach(e=>n(e)),s.length&&(a.push(o(s)),s="");return a}function m(e,t,i,r,a,s,o){e.beginPath(),e.moveTo(t+s,i),e.lineTo(t+r-s,i),e.quadraticCurveTo(t+r,i,t+r,i+s),e.lineTo(t+r,i+a-s),e.quadraticCurveTo(t+r,i+a,t+r-s,i+a),e.lineTo(t+s,i+a),e.quadraticCurveTo(t,i+a,t,i+a-s),e.lineTo(t,i+s),e.quadraticCurveTo(t,i,t+s,i),e.closePath(),e.fillStyle=o,e.fill()}function I(e){return e.includes("ads-latest")||0===e.indexOf(n.vI)}function E(e){return e.includes("analytics-latest")||0===e.indexOf(n.YD)}function P(e){return e.includes("trends-latest")||0===e.indexOf(n.L1)}function f(e,t){return e.isAuth&&e.isEmployee&&"true"===new URLSearchParams(t).get("debug")}function y(){let{isInternalIP:e}=(0,o.B)(),{search:t}=(0,r.TH)();return!!(e&&"true"===new URLSearchParams(t).get("force-publish-failure"))}function T(e){let{entryType:t,isAdsManagerIdeaPinDraft:i,isDraft:r,mediaType:a,storyPinSelectCount:s}=e;return{entry_type:t,is_ads_manager_idea_pin_draft:i??!1,is_draft:r,idea_pin_media_type:a,story_pin_select_count:s}}function A({disabledIdeaPinCreation:e,link:t,linkStatus:i,textBlocks:r,title:a}){let s=r.reduce((e,t)=>e||t.text.length>_.K3,!1),o=a.length>_.S8,n=!!(t&&i!==l.Dt.VALID);return e||o||s||n}},117043:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});var r=i(961936);let a={rotate:0,scaleX:1,scaleY:1};function s({canvasAspectRatio:e,media:t}){let i=t.width/t.height,s=r.q8/e,o=e=>(s-t.height*e)/2,n=({left:e,scale:t})=>({left:e||0,scale:t,top:o(t),transform:a});if(i<e)return n({scale:r.q8/t.width});{let e=s/t.height,i=t.width*e;return n({left:(r.q8-i)/2,scale:e})}}},961936:(e,t,i)=>{"use strict";i.d(t,{Af:()=>d,Ei:()=>l,II:()=>P,Lh:()=>g,U:()=>p,Zy:()=>n,dD:()=>s,er:()=>h,hb:()=>I,in:()=>_,j7:()=>m,kX:()=>u,mx:()=>E,n5:()=>o,q8:()=>c,xH:()=>a});var r=i(749886);let a=1048576,s=3,o=20,n=3,l=10,_=50,d=10,u=1200,c=375,p=375/r.ap,h=1200,g="#FFFFFF",m={blockStyle:{x_coord:4.27,y_coord:46.82,width:91.46,height:26.35,corner_radius:0},style:{font_id:6,hex_color:"#FFFFFF",font_size:36,alignment:1},text:"",type:"story_pin_paragraph_block"},I=420,E=325,P=768}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/75028.pl_PL-dd4c4572c43e4955.mjs.map